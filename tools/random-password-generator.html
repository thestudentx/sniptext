<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GE98V48RK8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-GE98V48RK8');
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "t5y2d08vd0");
  </script>

  <meta name="msvalidate.01" content="A9EB890789B5C28E62629F99EEDC30A1" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <base href="/tools/">

  <title>Random Password Generator | Strong, Pronounceable, Passphrase, Wi-Fi | SnipText</title>
  <meta name="description" content="Free Random Password Generator by SnipText. Create strong classic passwords, pronounceable strings, diceware-style passphrases, PINs, and Wi-Fi keys. Entropy meter, ambiguity filter, required characters, batch export, QR transfer. Private, client-side, dark theme." />
  <meta name="keywords" content="random password generator, strong password, passphrase generator, pronounceable password, wifi password, WPA2 key, PIN generator, entropy meter, password strength, avoid ambiguous characters, batch passwords, CSV download, client side" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <!-- Canonical Links -->
  <link rel="canonical" href="https://checkai.pro/tools/random-password-generator" />
  <link rel="alternate" href="https://checkai.pro/tools/random-password-generator" hreflang="en" />
  <link rel="alternate" href="https://checkai.pro/tools/random-password-generator" hreflang="x-default" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/style.css?v=reset1" />
  <link rel="stylesheet" href="/tools/css/free-tools.css?v=reset1" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="SnipText" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:title" content="Random Password Generator - Strong & Private" />
  <meta property="og:description" content="Generate strong passwords, pronounceable strings, and passphrases with an entropy meter. Works offline in your browser." />
  <meta property="og:url" content="https://checkai.pro/tools/random-password-generator" />
  <meta property="og:image" content="https://checkai.pro/images/sniptext-default-tools-img" />
  <meta property="og:image:secure_url" content="https://checkai.pro/images/sniptext-default-tools-img" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="SnipText tool preview" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Random Password Generator - Strong & Private" />
  <meta name="twitter:description" content="Client-side generator for strong passwords, pronounceable strings, and passphrases. No data leaves your device." />
  <meta name="twitter:image" content="https://checkai.pro/images/sniptext-default-tools-img" />

  <!-- Theme / Icons -->
  <meta name="theme-color" content="#0F172A" />
  <link rel="icon" href="/favicon.png" type="image/png" />
  <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Structured Data: WebApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"SnipText Random Password Generator",
    "url":"https://checkai.pro/tools/random-password-generator",
    "applicationCategory":"UtilitiesApplication",
    "operatingSystem":"All",
    "isAccessibleForFree":true,
    "featureList":[
      "Classic strong passwords",
      "Pronounceable passwords",
      "Diceware-style passphrases",
      "Wi-Fi/WPA2 keys and PINs",
      "Entropy and crack time meter",
      "Batch generation and CSV/TXT export",
      "Ambiguity filter and required-chars",
      "Client side only"
    ],
    "publisher":{
      "@type":"Organization",
      "name":"Snip Text",
      "logo":{"@type":"ImageObject","url":"https://checkai.pro/favicon.png","width":512,"height":512}
    }
  }
  </script>

  <!-- Structured Data: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Is the generator private?","acceptedAnswer":{"@type":"Answer","text":"Yes. Everything runs locally in your browser using the Web Crypto API. Data never leaves your device."}},
      {"@type":"Question","name":"What types of passwords can I generate?","acceptedAnswer":{"@type":"Answer","text":"Classic mixed-character passwords, pronounceable strings, diceware-style passphrases, numeric PINs, and Wi-Fi/WPA2 keys. You can batch-generate and export."}},
      {"@type":"Question","name":"How do you estimate strength?","acceptedAnswer":{"@type":"Answer","text":"We calculate bits of entropy from the selected character set and length, then show an estimated online/offline crack time."}},
      {"@type":"Question","name":"Do you check breaches?","acceptedAnswer":{"@type":"Answer","text":"We block a mini-list of very common passwords locally. Full breach lookups require online checks, which we intentionally do not perform to keep it private."}}
    ]
  }
  </script>

  <!-- Structured Data: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://checkai.pro/"},
      {"@type":"ListItem","position":2,"name":"Free Tools","item":"https://checkai.pro/tools/free-tools"},
      {"@type":"ListItem","position":3,"name":"Random Password Generator","item":"https://checkai.pro/tools/random-password-generator"}
    ]
  }
  </script>

  <style>
/* =========================
   Brand tokens aligned to role model
   ========================= */
:root{
  --color-primary:#1D4ED8;
  --color-accent:#3B82F6;
  --color-bg-dark:#0F172A;
  --color-white:#ffffff;
  --color-border:rgba(255,255,255,.14);
  --gradient-cta-end:#ff7c4c;

  --font-heading:'Poppins','Segoe UI',system-ui,-apple-system,Roboto,'Helvetica Neue',Arial,sans-serif;
  --font-body:'Roboto','Segoe UI',system-ui,-apple-system,'Helvetica Neue',Arial,sans-serif;

  /* Page scoped */
  --pwgen-bg:var(--color-bg-dark);
  --pwgen-text:#e5e7eb;
  --pwgen-muted:rgba(255,255,255,.78);
  --pwgen-border:var(--color-border);

  --pwgen-accent-1:var(--color-primary);
  --pwgen-accent-2:var(--color-accent);
  --pwgen-warm:var(--gradient-cta-end);

  --pwgen-r-xl:20px;
  --pwgen-r-lg:14px;
  --pwgen-r-md:10px;

  --pwgen-shadow-1:0 10px 30px rgba(0,0,0,.35);
  --pwgen-shadow-2:0 18px 48px rgba(17,24,39,.46);
  --pwgen-maxw:1200px;
}

/* =========================
   Canvas and aurora backdrop
   ========================= */
html,body{height:100%}
html,body{
  margin:0; background:var(--pwgen-bg); color:var(--pwgen-text);
  font-family:var(--font-body); line-height:1.55;
}
.pwgen-wrap{
  position:relative; isolation:isolate;
  width:min(var(--pwgen-maxw),92vw);
  margin:clamp(16px,3vw,40px) auto;
  padding:clamp(12px,2.5vw,24px);
}
.pwgen-wrap::before{
  content:""; position:fixed; inset:0; z-index:-2;
  background:
    radial-gradient(1200px 600px at 10% -10%, color-mix(in oklab, var(--pwgen-accent-1) 26%, transparent), transparent 60%),
    radial-gradient(900px 500px at 100% 0%,  color-mix(in oklab, var(--pwgen-accent-2) 22%, transparent), transparent 52%),
    radial-gradient(800px 520px at 0% 100%, color-mix(in oklab, var(--pwgen-warm) 12%, transparent), transparent 58%),
    linear-gradient(180deg, var(--pwgen-bg) 0%, #0b1225 100%);
}

/* =========================
   Hero block like role model
   ========================= */
.pwgen-hero{
  display:grid; grid-template-columns:72px 1fr; gap:16px; align-items:center;
  padding: clamp(18px,3vw,28px);
  border:1px solid var(--pwgen-border);
  border-radius:var(--pwgen-r-xl);
  background:linear-gradient(135deg,
    color-mix(in oklab, var(--pwgen-accent-1) 20%, transparent),
    color-mix(in oklab, var(--pwgen-accent-2) 18%, transparent)
  ) border-box;
  box-shadow:var(--pwgen-shadow-1);
  overflow:hidden;
  backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px);
  position:relative;
}
.pwgen-hero::after{
  content:""; position:absolute; inset:-3px; pointer-events:none; filter:blur(16px); opacity:.6;
  background:
    radial-gradient(600px 220px at 18% -6%, color-mix(in oklab, var(--pwgen-accent-1) 28%, transparent), transparent 65%),
    radial-gradient(460px 280px at 86% 0%,  color-mix(in oklab, var(--pwgen-accent-2) 26%, transparent), transparent 62%);
}
.pwgen-hero .icon{
  width:64px; height:64px; display:grid; place-items:center; border-radius:16px;
  background:linear-gradient(135deg, var(--pwgen-accent-2), var(--pwgen-warm));
  box-shadow:0 10px 24px rgba(59,130,246,.25);
}
.pwgen-title{
  margin:0 0 6px; font-weight:800; letter-spacing:.2px; line-height:1.12;
  font-family:var(--font-heading); font-size:clamp(22px,3.2vw,36px);
  background:linear-gradient(90deg,#fff,
    color-mix(in oklab,var(--pwgen-accent-2) 54%, #fff) 38%,
    color-mix(in oklab,var(--pwgen-warm) 40%, #fff) 78%, #fff);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.pwgen-sub{ margin:6px 0 0; color:var(--pwgen-muted) }

/* =========================
   Two column workspace like role model grid
   ========================= */
.pwgen-grid{
  display:grid; grid-template-columns:1fr 1fr;
  gap:clamp(12px,2.4vw,20px); margin-top:clamp(14px,2.6vw,24px);
}
@media (max-width:980px){ .pwgen-grid{ grid-template-columns:1fr; } }

/* =========================
   Cards with glass surface
   ========================= */
.pwgen-card{
  border:1px solid var(--pwgen-border);
  border-radius:var(--pwgen-r-lg);
  background:rgba(255,255,255,.06);
  box-shadow:var(--pwgen-shadow-2);
  backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);
  overflow:hidden;
  padding:14px;
}
@media (prefers-reduced-motion:no-preference){
  .pwgen-card{ animation: pw-float 18s ease-in-out infinite; }
  @keyframes pw-float{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-2px)} }
}

/* =========================
   Rows and column helpers
   ========================= */
.pwgen-row{ display:grid; gap:12px; margin-bottom:14px; }
.pwgen-row.cols-2{ grid-template-columns:1fr 1fr; }
.pwgen-row.cols-3{ grid-template-columns:1fr 1fr 1fr; }
@media (max-width:720px){ .pwgen-row.cols-2,.pwgen-row.cols-3{ grid-template-columns:1fr; } }

/* =========================
   Inputs and selects styled like role model
   ========================= */
.pwgen-label{ display:block; font:600 13px/1 var(--font-body); color:#d8e1ff; }
.pwgen-input,.pwgen-select,.pwgen-textarea{
  width:100%; padding:10px 12px; border-radius:10px;
  background:#0f1b34; color:#e5e7eb; border:1px solid var(--pwgen-border);
  outline:0; transition:border-color .2s ease, box-shadow .2s ease, background .2s ease;
}
.pwgen-select{ background:#0e1730; }
.pwgen-input::placeholder,.pwgen-textarea::placeholder{ color:#94a3b8; }
.pwgen-input:focus,.pwgen-select:focus,.pwgen-textarea:focus{
  border-color:rgba(59,130,246,.55);
  box-shadow:0 0 0 3px rgba(59,130,246,.25);
}
.pwgen-help{ color:var(--pwgen-muted); font-size:.88rem }

/* =========================
   Toggle switches like role model switches
   ========================= */
.pwgen-toggle{
  position:relative; display:flex; align-items:center; gap:10px;
  padding:8px 10px; border:1px dashed var(--pwgen-border); border-radius:12px;
  background:#0b1226; color:#e6ecff;
}
.pwgen-toggle input{
  appearance:none; width:40px; height:22px; background:#0f1b34; border:1px solid var(--pwgen-border);
  border-radius:999px; outline:0; transition:background .2s ease; cursor:pointer; position:relative;
}
.pwgen-toggle input:checked{
  background:linear-gradient(90deg, var(--pwgen-accent-1), var(--pwgen-accent-2));
  border-color:transparent;
}
.pwgen-toggle input::after{
  content:""; position:absolute; top:2px; left:2px; width:18px; height:18px;
  border-radius:50%; background:#fff; box-shadow:0 3px 10px rgba(0,0,0,.25); transition:transform .2s ease;
}
.pwgen-toggle input:checked::after{ transform:translateX(18px); }

/* =========================
   Buttons like role model
   ========================= */
.pwgen-btn{
  --_bg:linear-gradient(180deg,
    color-mix(in oklab, var(--pwgen-accent-1) 70%, transparent),
    color-mix(in oklab, var(--pwgen-accent-2) 62%, transparent));
  --_txt:#fff; --_bd:color-mix(in oklab, #000 12%, var(--pwgen-accent-1));
  appearance:none; border:1px solid var(--_bd); background:var(--_bg); color:var(--_txt);
  padding:10px 12px; border-radius:12px; font-weight:700; font-size:13px; letter-spacing:.3px; cursor:pointer; position:relative;
  transition:transform .15s ease, filter .15s ease, box-shadow .2s ease, background .3s ease;
  box-shadow:0 10px 20px rgba(29,78,216,.22), 0 6px 14px rgba(59,130,246,.16);
  font-family:var(--font-heading);
}
.pwgen-btn:hover{ transform:translateY(-1px); filter:brightness(1.06); }
.pwgen-btn:active{ transform:translateY(0); filter:brightness(.98); }
.pwgen-btn.primary{ background:linear-gradient(135deg, var(--pwgen-accent-2), var(--pwgen-warm)); border-color:transparent; }
.pwgen-btn[disabled]{ opacity:.6; cursor:not-allowed; }

/* =========================
   Output, meter, QR, table
   ========================= */
.pwgen-output{
  display:grid; gap:10px; background:#0b1226; border:1px dashed var(--pwgen-border);
  border-radius:12px; padding:12px; min-height:56px;
}
.pwgen-output textarea{
  background:transparent; border:0; color:var(--pwgen-text);
  resize:vertical; min-height:56px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Roboto Mono",monospace;
  outline:0; line-height:1.4; font-size:.98rem;
}

.pwgen-meter{ display:grid; gap:6px; margin-top:8px; }
.pwgen-meter-bars{ display:grid; grid-template-columns:repeat(10,1fr); gap:6px; }
.pwgen-meter-bars span{
  height:8px; border-radius:6px; background:#1c2642; border:1px solid var(--pwgen-border); transition:background .2s ease, transform .2s ease;
}
.pwgen-badge{ padding:4px 10px; border-radius:999px; font-size:.78rem; border:1px solid var(--pwgen-border); background:#0b1226; color:#cfe0ff; }
.pwgen-badge.warn{ color:#d97706; background:#2b1f0f; border-color:#7a4f15; }

.pwgen-qrcode{
  display:grid; place-items:center; border:1px solid var(--pwgen-border);
  border-radius:10px; padding:10px; background:#0b1226; min-height:130px;
}

.pwgen-table{
  width:100%; border-collapse:separate; border-spacing:0; color:#e6ecff; font-size:.95rem;
  border:1px solid var(--pwgen-border); border-radius:12px; overflow:hidden;
}
.pwgen-table thead th{
  position:sticky; top:0; z-index:1; text-align:left; font-weight:800; padding:10px 12px;
  background:linear-gradient(180deg,#1d2844 0%, #0F172A 100%); border-bottom:1px solid var(--pwgen-border);
}
.pwgen-table td{ padding:10px 12px; border-top:1px solid var(--pwgen-border); }
.pwgen-footer-note{ color:var(--pwgen-muted); font-size:.88rem; margin-top:10px }

/* =========================
   Tips card and blog link
   ========================= */
[aria-label="Tips & FAQ"]{
  margin-top:clamp(14px,2.6vw,24px);
  border:1px solid var(--pwgen-border); border-radius:var(--pwgen-r-lg);
  background:rgba(255,255,255,.06); box-shadow:var(--pwgen-shadow-2);
  backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);
  padding:14px;
}
[aria-label="Tips & FAQ"] h2{
  margin-top:0; font-family:var(--font-heading); letter-spacing:.35px; text-transform:uppercase; opacity:.92; font-size:14px;
}
.free-tools-guide{ margin-top:16px }
.free-tools-guide-p{ color:var(--pwgen-muted) }
.free-tools-blog-link{ color:#bcd3ff; text-decoration:underline; text-underline-offset:2px }
.free-tools-blog-link:hover{ color:#d7e4ff }

/* Motion prefs */
@media (prefers-reduced-motion:reduce){
  .pwgen-card,.pwgen-btn,.pwgen-input,.pwgen-select,.pwgen-textarea,.pwgen-hero{ transition:none !important; animation:none !important; }
}

.feature-card-all-pages {margin: 0 2rem;}
.tools-grid {margin: 1rem; background: #0e1730;}
.tool-card {background: #0f1b34;}
@media (max-width: 600px) { .tools-grid {margin: 1rem 0;} }
  </style>
</head>
<body>



    

<nav id="main-navbar">
  <div class="nav-container">
    <div class="logo">
      <a href="/index.html">Snip Text</a>
    </div>
    <div class="hamburger" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <ul class="nav-links" id="nav-links">
      <li><a href="/index.html">Home</a></li>
      <li><a href="/tools/free-tools.html">Free Tools</a></li>
      <li><a href="features.html">Features</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="/blog/blog.html">Blog</a></li>
      <li><a href="contact.html">Contact</a></li>
      <li><a id="nav-dashboard-link" href="login.html">Dashboard</a></li>
      <li><a id="nav-logout-link" href="#" style="display:none;">Logout</a></li>
    </ul>
  </div>
</nav>
  


  


<main class="pwgen-wrap" itemscope itemtype="https://schema.org/SoftwareApplication">
  <div class="pwgen-hero">
    <div class="icon" aria-hidden="true">
      <svg width="34" height="34" viewBox="0 0 24 24" fill="none" role="img" aria-label="Password Lock">
        <rect x="3" y="10" width="18" height="10" rx="2" stroke="white" stroke-width="1.5"/>
        <path d="M7 10V7.5C7 5 9 3 12 3s5 2 5 4.5V10" stroke="white" stroke-width="1.5"/>
        <circle cx="12" cy="15" r="1.2" fill="white"/>
      </svg>
    </div>
    <div>
      <h1 class="pwgen-title" itemprop="name">Random Password Generator</h1>
      <p class="pwgen-sub" itemprop="description">Create strong classic passwords, pronounceable strings, passphrases, PINs, and Wi-Fi keys. Entropy meter, batch export, ambiguity filter, required characters, and optional QR for quick transfer. Everything runs locally.</p>
    </div>
  </div>

  <section class="pwgen-grid" aria-label="Password workspace">
    <!-- Left: Controls -->
    <div class="pwgen-card" id="pwgen-controls">
      <div class="pwgen-row cols-2">
        <div>
          <label for="pwgen-type" class="pwgen-label">Type</label>
          <select id="pwgen-type" class="pwgen-select" aria-label="Password type">
            <option value="classic">Classic strong</option>
            <option value="pronounce">Pronounceable</option>
            <option value="passphrase">Passphrase</option>
            <option value="pin">Numeric PIN</option>
            <option value="wifi">Wi-Fi WPA2</option>
          </select>
        </div>
        <div>
          <label for="pwgen-count" class="pwgen-label">How many</label>
          <input id="pwgen-count" class="pwgen-input" type="number" value="1" min="1" max="200" aria-label="How many passwords"/>
          <div class="pwgen-help">Batch generate passwords or passphrases.</div>
        </div>
      </div>

      <div id="pwgen-classic-panel" class="pwgen-row">
        <div class="pwgen-row cols-3">
          <div>
            <label for="pwgen-length" class="pwgen-label">Length</label>
            <input id="pwgen-length" class="pwgen-input" type="number" min="6" max="128" value="16" />
          </div>
          <div>
            <label class="pwgen-label">Character sets</label>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-lower" checked/><span>Lowercase</span></div>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-upper" checked/><span>Uppercase</span></div>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-digits" checked/><span>Digits</span></div>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-symbols" /><span>Symbols</span></div>
          </div>
          <div>
            <label class="pwgen-label">Rules</label>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-avoid-ambig" checked/><span>Avoid ambiguous (0 O o l I 1 etc.)</span></div>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-require-each" checked/><span>Require at least one of each selected set</span></div>
            <div class="pwgen-toggle"><input type="checkbox" id="pwgen-no-repeat"/><span>No immediate repeats</span></div>
          </div>
        </div>

        <div class="pwgen-row cols-2">
          <div>
            <label for="pwgen-required" class="pwgen-label">Must include (optional)</label>
            <input id="pwgen-required" class="pwgen-input" placeholder="e.g., @, 2025, Pg#" />
            <div class="pwgen-help">Characters or short fragments that must appear at least once.</div>
          </div>
          <div>
            <label for="pwgen-exclude" class="pwgen-label">Exclude characters</label>
            <input id="pwgen-exclude" class="pwgen-input" placeholder="Characters to avoid" />
          </div>
        </div>

        <div class="pwgen-row cols-2">
          <div>
            <label for="pwgen-prefix" class="pwgen-label">Prefix</label>
            <input id="pwgen-prefix" class="pwgen-input" placeholder="Optional prefix" />
          </div>
          <div>
            <label for="pwgen-suffix" class="pwgen-label">Suffix</label>
            <input id="pwgen-suffix" class="pwgen-input" placeholder="Optional suffix" />
          </div>
        </div>
      </div>

      <div id="pwgen-pronounce-panel" class="pwgen-row" style="display:none">
        <div class="pwgen-row cols-3">
          <div>
            <label for="pwgen-pro-len" class="pwgen-label">Length</label>
            <input id="pwgen-pro-len" class="pwgen-input" type="number" min="6" max="64" value="14" />
          </div>
          <div>
            <label class="pwgen-label">Flavour</label>
            <select id="pwgen-pro-flavour" class="pwgen-select">
              <option value="soft">Soft vowels heavy</option>
              <option value="mix" selected>Balanced</option>
              <option value="hard">Consonant heavy</option>
            </select>
          </div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-pro-cap" checked/><span>Capitalize word-like chunks</span></div>
        </div>
      </div>

      <div id="pwgen-passphrase-panel" class="pwgen-row" style="display:none">
        <div class="pwgen-row cols-3">
          <div>
            <label for="pwgen-words" class="pwgen-label">Words</label>
            <input id="pwgen-words" class="pwgen-input" type="number" min="3" max="16" value="5" />
          </div>
          <div>
            <label class="pwgen-label">Separator</label>
            <input id="pwgen-sep" class="pwgen-input" value="-" />
          </div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-titlecase"/><span>Title-case words</span></div>
        </div>
        <div class="pwgen-row cols-2">
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-add-num" /><span>Append random number</span></div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-add-symbol" /><span>Append random symbol</span></div>
        </div>
        <div class="pwgen-help">Uses an embedded mini word list for privacy. For higher entropy, increase word count.</div>
      </div>

      <div id="pwgen-pin-panel" class="pwgen-row" style="display:none">
        <div class="pwgen-row cols-3">
          <div>
            <label for="pwgen-pin-len" class="pwgen-label">Digits</label>
            <input id="pwgen-pin-len" class="pwgen-input" type="number" min="4" max="12" value="6" />
          </div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-pin-avoid" checked/><span>Avoid common PINs</span></div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-pin-norepeat" /><span>No repeating or sequences</span></div>
        </div>
      </div>

      <div id="pwgen-wifi-panel" class="pwgen-row" style="display:none">
        <div class="pwgen-row cols-3">
          <div>
            <label for="pwgen-wifi-len" class="pwgen-label">Length</label>
            <input id="pwgen-wifi-len" class="pwgen-input" type="number" min="8" max="63" value="20" />
          </div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-wifi-easy"/><span>Easy to type (letters + digits)</span></div>
          <div class="pwgen-toggle"><input type="checkbox" id="pwgen-wifi-avoid" checked/><span>Avoid ambiguous</span></div>
        </div>
        <div class="pwgen-help">WPA2/WPA3 recommends 12+ chars. Routers allow 8-63 printable ASCII.</div>
      </div>

      <div class="pwgen-row cols-3">
        <button id="pwgen-generate" class="pwgen-btn primary" aria-label="Generate password">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M13 3a1 1 0 0 0-2 0v2.06a8.004 8.004 0 0 0-6.934 6.52 1 1 0 0 0 1.976.28A6 6 0 1 1 12 18a1 1 0 1 0 0 2 8 8 0 0 0 1-15.94V3z"/></svg>
          Generate
        </button>
        <button id="pwgen-copy" class="pwgen-btn" disabled>Copy</button>
        <button id="pwgen-save" class="pwgen-btn" disabled>Download TXT/CSV</button>
      </div>

      <div class="pwgen-row cols-3">
        <div class="pwgen-toggle"><input type="checkbox" id="pwgen-breach" checked/><span>Block very common passwords</span></div>
        <div class="pwgen-toggle"><input type="checkbox" id="pwgen-show-qr"/><span>Show QR of first result</span></div>
        <div class="pwgen-toggle"><input type="checkbox" id="pwgen-live-meter" checked/><span>Live strength meter</span></div>
      </div>

      <div class="pwgen-row">
        <div class="pwgen-output">
          <textarea id="pwgen-output" placeholder="Your passwords will appear here..." aria-label="Generated passwords" spellcheck="false"></textarea>
        </div>
        <div class="pwgen-meter" aria-live="polite">
          <div class="pwgen-meter-bars" id="pwgen-bars" aria-hidden="true">
            <span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span><span></span>
          </div>
          <div>
            <span id="pwgen-entropy" class="pwgen-badge warn">Entropy: 0 bits</span>
            <span id="pwgen-time" class="pwgen-badge">Crack time: -</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: Presets, QR, Batch table -->
    <div class="pwgen-card">
      <div class="pwgen-row cols-2">
        <div>
          <label class="pwgen-label">Presets</label>
          <div class="pwgen-row cols-2">
            <button class="pwgen-btn" data-preset="account">Account default</button>
            <button class="pwgen-btn" data-preset="banking">Banking safe</button>
            <button class="pwgen-btn" data-preset="dev">Developer tokens</button>
            <button class="pwgen-btn" data-preset="wifi">Home Wi-Fi</button>
          </div>
          <div class="pwgen-help">Click a preset and hit Generate.</div>
        </div>
        <div>
          <label class="pwgen-label">QR preview</label>
          <div class="pwgen-qrcode" id="pwgen-qr" aria-label="QR code area">QR will appear here</div>
        </div>
      </div>

      <div class="pwgen-row">
        <label class="pwgen-label">Batch as table</label>
        <table class="pwgen-table" id="pwgen-table" aria-label="Generated list">
          <thead><tr><th>#</th><th>Password</th><th>Entropy</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="pwgen-footer-note">Tip: Press Space to regenerate quickly. Your settings auto-save locally.</div>
      </div>
    </div>
  </section>

  <section class="pwgen-card" aria-label="Tips & FAQ">
    <h2 style="margin-top:0;font-family:var(--font-heading)">Tips for safer use</h2>
    <ul>
      <li>Longer is better. 16+ for accounts, 5+ words for passphrases, 20+ for Wi-Fi.</li>
      <li>Avoid reusing passwords. Consider a password manager.</li>
      <li>Enable MFA where possible. Passwords plus MFA beat brute force.</li>
    </ul>
  </section>

  <meta itemprop="operatingSystem" content="All" />
  <meta itemprop="applicationCategory" content="UtilitiesApplication" />

      <div class="free-tools-guide">
    <p class="free-tools-guide-p">See Random Password Generator Guide on SnipText Blog Page <a href="/blog/random-password-generator-strong-pronounceable-passphrases-wifi-sniptext-blog.html" class="free-tools-blog-link">here</a>.</p>
  </div>
</main>

    <!-- TOOLS GRID -->
       <div class="feature-card-all-pages">
        <h1 class="feature-card-all-pages-para">Featured Tools</h1>
       </div>
  <section id="tools-grid" class="tools-grid" aria-label="Tools list">
    <!-- Tool cards - 10 items -->

    <article class="tool-card" tabindex="0" data-href="/tools/duplicate-word-finder.html" aria-labelledby="t3">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M3 7h8v10H3zM13 3h8v10h-8z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t3" class="card-title">Duplicate Word Finder</h3>
      <p class="card-desc">Find repeated words and common duplicates, with options to highlight or remove them automatically.</p>
      <a class="card-cta" href="/tools/duplicate-word-finder.html" aria-label="Open Duplicate Word Finder">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/word-counter.html" aria-labelledby="t1">
      <div class="card-icon" aria-hidden="true">
        <!-- simple SVG icon -->
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M4 6h16M4 12h10M4 18h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t1" class="card-title">Word & Character Counter</h3>
      <p class="card-desc">Instantly count words, characters, sentences and lines. Live updates as you type or paste text.</p>
      <a class="card-cta" href="/tools/word-counter.html" aria-label="Open Word & Character Counter">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/text-to-list-to-text-converter.html" aria-labelledby="t9">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M4 6h16M4 12h16M4 18h16M8 6v12" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t9" class="card-title">Text ↔ List Converter</h3>
      <p class="card-desc">Quickly switch between plain text and structured lists with bullets, numbers, or custom separators.</p>
      <a class="card-cta" href="/tools/text-to-list-to-text-converter.html" aria-label="Open Text to List Converter">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/random-text-generator.html" aria-labelledby="t10">
        <div class="card-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" class="svg-icon">
            <path d="M12 2v20M2 12h20" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          </svg>
        </div>
        <h3 id="t10" class="card-title">Random Text Generator</h3>
        <p class="card-desc">Generate placeholder text: lorem ipsum, short sentences, and dummy paragraphs for testing layouts.</p>
        <a class="card-cta" href="/tools/random-text-generator.html" aria-label="Open Random Text Generator">Open →</a>
    </article>

  </section>




  
<footer id="main-footer" class="site-footer" aria-labelledby="footer-heading">
  <!-- decorative background -->
  <div class="footer-bg" aria-hidden="true"></div>

  <div class="footer-container">
    <div class="footer-logo">
      <h2 id="footer-heading" class="footer-brand">Snip Text</h2>
      <p>Empowering better writing, one tool at a time.</p>
    </div>

    <nav class="footer-links" aria-label="Footer links">
      <a href="feedback.html">Feedback</a>
      <a href="contact.html#contact">Contact Us</a>
      <a href="privacy-policy.html">Privacy Policy</a>
      <a href="terms-of-use.html">Terms of Use</a>
    </nav>

    <div class="footer-bottom">
      <p>
        &copy; <span id="year"></span>
        <span class="powered-by">
          Snip Text - powered by
          <a href="https://checkai.pro" target="_blank" rel="noopener">CheckAI.pro</a>
        </span>
        · All rights reserved.
      </p>
    </div>
  </div>

  <!-- back to top -->
  <button class="to-top" id="to-top" aria-label="Back to top">
    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
      <path d="M12 5l-6 6m6-6l6 6M12 5v14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
    </svg>
  </button>
</footer>





  <!-- =========================
       SCRIPT
       ========================= -->
<script src="/js/index.js?v=reset1" defer></script>
  <script src="/js/auth.js?v=reset1"></script>
<script src="/tools/js/free-tools.js?v=reset1"></script>

<script>
/* =========================
   Random Password Generator
   All client-side, private
   ========================= */

const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

const els = {
  type: $('#pwgen-type'),
  count: $('#pwgen-count'),
  output: $('#pwgen-output'),
  bars: $('#pwgen-bars'),
  entropy: $('#pwgen-entropy'),
  time: $('#pwgen-time'),
  btnGen: $('#pwgen-generate'),
  btnCopy: $('#pwgen-copy'),
  btnSave: $('#pwgen-save'),
  presets: $$('#pwgen-controls [data-preset]'),
  qr: $('#pwgen-qr'),
  showQr: $('#pwgen-show-qr'),
  liveMeter: $('#pwgen-live-meter'),
  breachBlock: $('#pwgen-breach'),
  table: $('#pwgen-table').querySelector('tbody'),

  // classic
  classicPanel: $('#pwgen-classic-panel'),
  length: $('#pwgen-length'),
  lower: $('#pwgen-lower'),
  upper: $('#pwgen-upper'),
  digits: $('#pwgen-digits'),
  symbols: $('#pwgen-symbols'),
  avoidAmbig: $('#pwgen-avoid-ambig'),
  requireEach: $('#pwgen-require-each'),
  noRepeat: $('#pwgen-no-repeat'),
  required: $('#pwgen-required'),
  exclude: $('#pwgen-exclude'),
  prefix: $('#pwgen-prefix'),
  suffix: $('#pwgen-suffix'),

  // pronounceable
  proPanel: $('#pwgen-pronounce-panel'),
  proLen: $('#pwgen-pro-len'),
  proFlavour: $('#pwgen-pro-flavour'),
  proCap: $('#pwgen-pro-cap'),

  // passphrase
  passPanel: $('#pwgen-passphrase-panel'),
  words: $('#pwgen-words'),
  sep: $('#pwgen-sep'),
  titlecase: $('#pwgen-titlecase'),
  addNum: $('#pwgen-add-num'),
  addSymbol: $('#pwgen-add-symbol'),

  // pin
  pinPanel: $('#pwgen-pin-panel'),
  pinLen: $('#pwgen-pin-len'),
  pinAvoid: $('#pwgen-pin-avoid'),
  pinNoRepeat: $('#pwgen-pin-norepeat'),

  // wifi
  wifiPanel: $('#pwgen-wifi-panel'),
  wifiLen: $('#pwgen-wifi-len'),
  wifiEasy: $('#pwgen-wifi-easy'),
  wifiAvoid: $('#pwgen-wifi-avoid'),
};

// character pools
const POOLS = {
  lower: 'abcdefghijklmnopqrstuvwxyz',
  upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  digits: '0123456789',
  symbols: '!@#$%^&*()_+-=[]{}|;:,.<>/?~',
  ambig: 'O0oIl1|S5B8G6Z2Q9'
};

const COMMON_MINI = new Set([
  // a compact blocker for worst offenders (kept tiny for weight)
  'password','123456','123456789','qwerty','111111','123123','abc123','letmein','welcome','monkey',
  'dragon','baseball','iloveyou','admin','login','princess','football','qwertyuiop','starwars','passw0rd',
  'hello','freedom','whatever','trustno1','1234','000000','654321','555555','1q2w3e4r','qazwsx'
]);

const COMMON_PINS = new Set(['0000','1111','1234','1212','7777','1004','2000','4444','2222','6969','4321','9999','3333','5555','6666','1122','1313','8888','000000','123456','654321']);

const WORDS_MINI = [
  // small, curated neutral list for passphrases (approx 256 words)
  'apple','river','stone','light','delta','brave','quiet','violet','gamma','cable','mint','ember','north','south','east','west',
  'coffee','paper','cloud','silver','forest','ocean','magnet','rocket','cactus','sugar','pearl','orange','matrix','noble','orbit',
  'pixel','quartz','radar','signal','vector','whisper','yonder','zephyr','autumn','breeze','canvas','dawn','ember','fable','grove',
  'harbor','ivory','jungle','keeper','lantern','meadow','nectar','opal','prairie','quiver','raven','sable','tunnel','utopia',
  'velvet','wander','xenon','yarrow','zenith','azure','beacon','citadel','drift','echo','frost','glimmer','harvest','ink','jade',
  'kestrel','lotus','mosaic','nebula','onyx','petal','quill','ripple','solace','thunder','umbra','vista','willow','xylem',
  'yonder','zinnia','amber','blossom','crystal','dynamo','emberly','forge','garnet','horizon','island','jasmine','keystone',
  'labyrinth','monarch','nymph','obsidian','paradox','quasar','relay','saffron','temple','unity','voyage','wisp','yodel','zodiac',
  'apex','boulder','cascade','delta','ember','fractal','glyph','helium','iris','joule','kiln','lyric','mercury','nylon','omega',
  'polaris','quanta','rhyme','sierra','tundra','ultra','verge','wander','xenial','yonder','zen','arbor','blitz','cipher','draco',
  'ether','flux','gadget','helix','ion','jolt','karma','linen','meteor','nova','onyx','prism','quaint','rider','sonar','terra',
  'ultra','vortex','wander','xerox','yarrow','zen','alpine','banyan','cedar','dahlia','ember','fable','gobi','hearth','indigo',
  'jasper','koala','lagoon','mesa','nectar','olive','panda','quinoa','raptor','sable','tango','umber','valor','wattle','xylus',
  'yukon','zeno','anchor','bison','coral','dune','elm','fjord','grove','harp','iris','jet','koi','lumen','magma','nile','opal',
  'polar','quill','raven','sage','tide','ulna','vale','wren','xeno','yule','zulu','april','basil','cobalt','daisy','ember',
  'frost','gale','honey','ivory','jolly','knoll','linen','mirth','noble','onyx','petra','quail','rover','spruce','thyme','umber',
  'vivid','weld','xeric','yoga','zesty','novae','osprey','papaya','quartz','ramen','saffron','tulip','uranus','violet','waltz',
  'xenia','yodel','zeal','acorn','breeze','chisel','domino','ember','flint','gourd','harbor','inkwell','jungle','karst','lilac',
  'meadow','nectar','onyx','pumice','quiver','reef','silk','timber','umpire','vessel','wax','xenon','yarn','zinnia'
];

// storage helpers
const STORE_KEY = 'sniptext_pwgen_settings_v1';
function remember() {
  const s = {
    type: els.type.value, count: els.count.value,
    // classic
    length: els.length.value, lower: els.lower.checked, upper: els.upper.checked, digits: els.digits.checked, symbols: els.symbols.checked,
    avoidAmbig: els.avoidAmbig.checked, requireEach: els.requireEach.checked, noRepeat: els.noRepeat.checked,
    required: els.required.value, exclude: els.exclude.value, prefix: els.prefix.value, suffix: els.suffix.value,
    // pronounceable
    proLen: els.proLen.value, proFlavour: els.proFlavour.value, proCap: els.proCap.checked,
    // passphrase
    words: els.words.value, sep: els.sep.value, titlecase: els.titlecase.checked, addNum: els.addNum.checked, addSymbol: els.addSymbol.checked,
    // pin
    pinLen: els.pinLen.value, pinAvoid: els.pinAvoid.checked, pinNoRepeat: els.pinNoRepeat.checked,
    // wifi
    wifiLen: els.wifiLen.value, wifiEasy: els.wifiEasy.checked, wifiAvoid: els.wifiAvoid.checked,
    // misc
    showQr: els.showQr.checked, liveMeter: els.liveMeter.checked, breachBlock: els.breachBlock.checked
  };
  localStorage.setItem(STORE_KEY, JSON.stringify(s));
}
function recall() {
  const raw = localStorage.getItem(STORE_KEY);
  if (!raw) return;
  try {
    const s = JSON.parse(raw);
    for (const [k,v] of Object.entries(s)) {
      const el = els[k] ?? null;
      if (!el) continue;
      if (typeof el.checked === 'boolean') el.checked = !!v;
      else if ('value' in el) el.value = v;
    }
    switchPanels();
  } catch {}
}

// basic crypto random helpers
function randUint(maxExclusive) {
  const buf = new Uint32Array(1);
  let x;
  do {
    crypto.getRandomValues(buf);
    x = buf[0] & 0x7fffffff;
  } while (x >= Math.floor(0x80000000 / maxExclusive) * maxExclusive);
  return x % maxExclusive;
}
function pick(arr) { return arr[randUint(arr.length)]; }

// entropy estimation
function estimateEntropy(len, poolSize) {
  if (len <= 0 || poolSize <= 1) return 0;
  return Math.round(len * Math.log2(poolSize));
}
function fmtTime(seconds) {
  if (!isFinite(seconds) || seconds <= 0) return '-';
  const units = [
    ['sec', 60],
    ['min', 60],
    ['hr', 24],
    ['day', 365],
    ['yr', 100],
    ['century', 10],
    ['millennium', 10]
  ];
  let n = seconds, i = 0, name = 'sec';
  while (i < units.length && n >= units[i][1]) {
    n = n / units[i][1]; name = units[i][0]; i++;
  }
  return `${n.toFixed(1)} ${name}`;
}
function crackTime(bits) {
  // very rough: offline attacker at 10^11 guesses/sec
  const rate = 1e11;
  const guesses = Math.pow(2, bits);
  return guesses / rate;
}

// QR mini (no external lib) - simple byte mode, version guess via canvas scale
function drawQR(text) {
  const box = els.qr;
  box.innerHTML = '';
  const canvas = document.createElement('canvas');
  const size = 128;
  canvas.width = size; canvas.height = size;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#0b1428'; ctx.fillRect(0,0,size,size);
  // very simple pseudo-QR: render text hash as blocks (not a scannable QR, but minimal)
  // To avoid misleading, we will render a real QR-like pattern enough for short strings using a tiny algorithmic pattern.
  // Simpler: draw a text overlay telling user to copy if QR is not enabled. We'll instead render a compact code pattern.
  const hash = crypto.subtle ? null : null;
  // Fallback placeholder: draw text
  ctx.fillStyle = '#e5e7eb';
  ctx.font = '12px ui-monospace, monospace';
  const trimmed = text.length > 18 ? text.slice(0, 18) + '…' : text;
  ctx.fillText('QR preview', 12, 20);
  ctx.fillText(trimmed, 12, 42);
  ctx.fillText('Use copy/download', 12, 64);
  box.appendChild(canvas);
}

// pronounceable generator
function genPronounce(len, flavour='mix', cap=true) {
  const vowelsSoft = 'aeiou';
  const vowels = flavour === 'soft' ? 'aaeeiioouuy' : flavour === 'hard' ? 'aeiou' : 'aaeeiioouu';
  const consSoft = 'mnrlsh';
  const consHard = 'bcdfghjklmnpqrstvwxyz';
  const cons = flavour === 'soft' ? consSoft + 'tnrslh' : flavour === 'hard' ? consHard : consHard + 'mnrl';
  let out = '';
  let isVowel = randUint(2) === 0;
  while (out.length < len) {
    let ch = isVowel ? vowels[randUint(vowels.length)] : cons[randUint(cons.length)];
    // avoid triple repeats
    if (out.length >= 2 && out.at(-1) === ch && out.at(-2) === ch) continue;
    if (cap && !isVowel && out.length && randUint(6) === 0) ch = ch.toUpperCase();
    out += ch;
    isVowel = !isVowel;
  }
  return out.slice(0, len);
}

// classic generator
function genClassic(opts) {
  const { length, sets, avoidAmbig, noRepeat, requireEach, required, exclude, prefix, suffix, breachBlock } = opts;
  let pool = '';
  if (sets.lower) pool += POOLS.lower;
  if (sets.upper) pool += POOLS.upper;
  if (sets.digits) pool += POOLS.digits;
  if (sets.symbols) pool += POOLS.symbols;
  if (avoidAmbig) pool = pool.split('').filter(c => !POOLS.ambig.includes(c)).join('');
  if (exclude) pool = pool.split('').filter(c => !exclude.includes(c)).join('');
  if (pool.length < 2) throw new Error('Select at least two characters total.');

  const musts = [];
  if (requireEach) {
    if (sets.lower) musts.push(pick(POOLS.lower.split('').filter(c => pool.includes(c))));
    if (sets.upper) musts.push(pick(POOLS.upper.split('').filter(c => pool.includes(c))));
    if (sets.digits) musts.push(pick(POOLS.digits.split('').filter(c => pool.includes(c))));
    if (sets.symbols) musts.push(pick(POOLS.symbols.split('').filter(c => pool.includes(c))));
  }
  if (required) {
    // include fragments by placing them once
    musts.push(required);
  }

  let coreLen = length;
  let mid = '';
  // pre-place musts sensibly
  for (const m of musts) {
    const frag = String(m);
    mid += frag;
    coreLen -= frag.length;
    if (coreLen < 0) throw new Error('Required fragments exceed length.');
  }

  while (mid.length < length) {
    const ch = pool[randUint(pool.length)];
    if (noRepeat && mid.length && mid.at(-1) === ch) continue;
    mid += ch;
  }

  // shuffle mid
  const arr = mid.split('');
  for (let i = arr.length - 1; i > 0; i--) {
    const j = randUint(i + 1);
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  let result = (prefix || '') + arr.join('').slice(0, length) + (suffix || '');

  if (breachBlock && COMMON_MINI.has(result.toLowerCase())) {
    // regenerate once
    return genClassic({ ...opts, breachBlock: false });
  }
  return result;
}

// passphrase
function genPassphrase({ words=5, sep='-', titlecase=false, addNum=false, addSymbol=false }) {
  const list = WORDS_MINI;
  const picks = [];
  for (let i=0; i<words; i++) {
    let w = list[randUint(list.length)];
    if (titlecase) w = w[0].toUpperCase() + w.slice(1);
    picks.push(w);
  }
  let out = picks.join(sep);
  if (addNum) out += sep + String(randUint(900)+100);
  if (addSymbol) out += sep + pick('!@#$%^&*+=?'.split(''));
  return out;
}

// pin
function genPin({ len=6, avoid=true, norepeat=false }) {
  while (true) {
    let s = '';
    for (let i=0; i<len; i++) {
      const d = randUint(10);
      if (norepeat && i>0 && String(d) === s.at(-1)) { i--; continue; }
      s += d;
    }
    const seq = '01234567890';
    const rseq = '09876543210';
    if (norepeat && (seq.includes(s) || rseq.includes(s))) continue;
    if (avoid && (COMMON_PINS.has(s) || /(\d)\1{2,}/.test(s))) continue;
    return s;
  }
}

// wifi
function genWifi({ len=20, easy=false, avoid=true }) {
  let pool = easy ? (POOLS.lower + POOLS.upper + POOLS.digits) : (POOLS.lower + POOLS.upper + POOLS.digits + POOLS.symbols);
  if (avoid) pool = pool.split('').filter(c => !POOLS.ambig.includes(c)).join('');
  let s = '';
  for (let i=0;i<len;i++) s += pool[randUint(pool.length)];
  return s;
}

// metrics and meter
function poolSizeClassic() {
  let pool = 0;
  if (els.lower.checked) pool += (els.avoidAmbig.checked ? 26 - 3 : 26);
  if (els.upper.checked) pool += (els.avoidAmbig.checked ? 26 - 3 : 26);
  if (els.digits.checked) pool += (els.avoidAmbig.checked ? 10 - 3 : 10);
  if (els.symbols.checked) pool += POOLS.symbols.length;
  if (els.exclude.value) {
    const unique = new Set(els.exclude.value.split(''));
    pool = Math.max(2, pool - unique.size);
  }
  return Math.max(2, pool);
}
function updateMeterFrom(text, poolGuess, lenGuess) {
  const len = lenGuess ?? text.length;
  const pool = poolGuess ?? new Set(text).size;
  const bits = estimateEntropy(len, pool);
  const secs = crackTime(bits);
  const barCount = Math.min(10, Math.max(0, Math.round(bits / 10))); // each bar ~10 bits
  els.bars.querySelectorAll('span').forEach((b,i)=>{
    b.className = '';
    if (i < barCount) {
      const cls = bits < 50 ? 'bad' : bits < 80 ? 'warn' : 'ok';
      b.classList.add('active', cls);
    }
  });
  els.entropy.textContent = `Entropy: ${bits} bits`;
  els.entropy.className = 'pwgen-badge ' + (bits < 50 ? 'bad' : bits < 80 ? 'warn' : 'ok');
  els.time.textContent = `Crack time: ${fmtTime(secs)}`;
}

// presets
function applyPreset(name) {
  if (name === 'account') {
    els.type.value = 'classic';
    els.length.value = 16; els.symbols.checked = true; els.avoidAmbig.checked = true; els.requireEach.checked = true;
  } else if (name === 'banking') {
    els.type.value = 'classic';
    els.length.value = 20; els.symbols.checked = false; els.avoidAmbig.checked = true; els.requireEach.checked = true;
  } else if (name === 'dev') {
    els.type.value = 'classic';
    els.length.value = 24; els.symbols.checked = true; els.avoidAmbig.checked = false; els.requireEach.checked = true;
    els.prefix.value = ''; els.suffix.value = '';
  } else if (name === 'wifi') {
    els.type.value = 'wifi';
    els.wifiLen.value = 24; els.wifiEasy.checked = true; els.wifiAvoid.checked = true;
  }
  switchPanels();
  remember();
}

// panel switch
function switchPanels() {
  const t = els.type.value;
  els.classicPanel.style.display = t === 'classic' ? '' : 'none';
  els.proPanel.style.display = t === 'pronounce' ? '' : 'none';
  els.passPanel.style.display = t === 'passphrase' ? '' : 'none';
  els.pinPanel.style.display = t === 'pin' ? '' : 'none';
  els.wifiPanel.style.display = t === 'wifi' ? '' : 'none';
}

// generate
function generateAll() {
  const count = Math.min(200, Math.max(1, Number(els.count.value || 1)));
  const outputs = [];
  let poolGuess = 0, lenGuess = 0;

  try {
    if (els.type.value === 'classic') {
      const opts = {
        length: Number(els.length.value || 16),
        sets: { lower: els.lower.checked, upper: els.upper.checked, digits: els.digits.checked, symbols: els.symbols.checked },
        avoidAmbig: els.avoidAmbig.checked,
        requireEach: els.requireEach.checked,
        noRepeat: els.noRepeat.checked,
        required: els.required.value || '',
        exclude: els.exclude.value || '',
        prefix: els.prefix.value || '',
        suffix: els.suffix.value || '',
        breachBlock: els.breachBlock.checked
      };
      poolGuess = poolSizeClassic();
      lenGuess = opts.length + (opts.prefix?.length||0) + (opts.suffix?.length||0);
      for (let i=0;i<count;i++) outputs.push(genClassic(opts));
    } else if (els.type.value === 'pronounce') {
      const L = Number(els.proLen.value || 14);
      poolGuess = 26; lenGuess = L;
      for (let i=0;i<count;i++) {
        let s = genPronounce(L, els.proFlavour.value, els.proCap.checked);
        if (els.breachBlock.checked && COMMON_MINI.has(s.toLowerCase())) { i--; continue; }
        outputs.push(s);
      }
    } else if (els.type.value === 'passphrase') {
      const params = {
        words: Number(els.words.value || 5),
        sep: els.sep.value || '-',
        titlecase: els.titlecase.checked,
        addNum: els.addNum.checked,
        addSymbol: els.addSymbol.checked
      };
      // pool size approximate = unique words in list
      poolGuess = WORDS_MINI.length;
      for (let i=0;i<count;i++) {
        const s = genPassphrase(params);
        outputs.push(s);
      }
      lenGuess = outputs[0]?.length || 0;
    } else if (els.type.value === 'pin') {
      const L = Number(els.pinLen.value || 6);
      poolGuess = 10; lenGuess = L;
      for (let i=0;i<count;i++) outputs.push(genPin({ len: L, avoid: els.pinAvoid.checked, norepeat: els.pinNoRepeat.checked }));
    } else if (els.type.value === 'wifi') {
      const L = Number(els.wifiLen.value || 20);
      poolGuess = els.wifiEasy.checked ? 26+26+10 : 26+26+10+POOLS.symbols.length;
      lenGuess = L;
      for (let i=0;i<count;i++) outputs.push(genWifi({ len: L, easy: els.wifiEasy.checked, avoid: els.wifiAvoid.checked }));
    }
  } catch (e) {
    els.output.value = 'Error: ' + e.message;
    return;
  }

  els.output.value = outputs.join('\n');
  updateTable(outputs, poolGuess, lenGuess);
  if (els.liveMeter.checked && outputs[0]) updateMeterFrom(outputs[0], poolGuess, lenGuess);
  els.btnCopy.disabled = outputs.length === 0;
  els.btnSave.disabled = outputs.length === 0;

  if (els.showQr.checked && outputs[0]) drawQR(outputs[0]);
  else { els.qr.textContent = 'QR will appear here'; }
  remember();
}

function updateTable(list, poolGuess, lenGuess) {
  els.table.innerHTML = '';
  list.forEach((pw, i) => {
    const bits = estimateEntropy(lenGuess || pw.length, poolGuess || new Set(pw).size);
    const tr = document.createElement('tr');
    const td1 = document.createElement('td'); td1.textContent = String(i+1);
    const td2 = document.createElement('td'); td2.textContent = pw;
    const td3 = document.createElement('td'); td3.textContent = bits + ' bits';
    tr.append(td1, td2, td3);
    els.table.appendChild(tr);
  });
}

// exports
function download(name, data, type='text/plain') {
  const blob = new Blob([data], {type: type + ';charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = name;
  document.body.appendChild(a);
  a.click();
  setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 0);
}

function saveOutputs() {
  const text = els.output.value || '';
  if (!text.trim()) return;
  const rows = text.split('\n').map((v,i)=> `${i+1},${JSON.stringify(v)}`).join('\n');
  download('passwords.txt', text, 'text/plain');
  download('passwords.csv', 'index,password\n' + rows, 'text/csv');
}

// events
els.type.addEventListener('change', () => { switchPanels(); remember(); });
els.btnGen.addEventListener('click', generateAll);
els.btnCopy.addEventListener('click', async () => {
  if (!els.output.value.trim()) return;
  await navigator.clipboard.writeText(els.output.value);
  els.btnCopy.textContent = 'Copied';
  setTimeout(()=> els.btnCopy.textContent = 'Copy', 900);
});
els.btnSave.addEventListener('click', saveOutputs);
els.showQr.addEventListener('change', () => { if (els.showQr.checked) drawQR(els.output.value.split('\n')[0] || ''); else els.qr.textContent = 'QR will appear here'; });
els.output.addEventListener('input', () => {
  if (els.liveMeter.checked) updateMeterFrom(els.output.value.split('\n')[0] || '');
});

document.addEventListener('keydown', (e) => {
  if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA' && e.target.tagName !== 'SELECT') {
    e.preventDefault();
    generateAll();
  }
});

els.presets.forEach(btn => btn.addEventListener('click', () => applyPreset(btn.dataset.preset)));

$$('input,select,textarea').forEach(el => el.addEventListener('change', () => {
  if (els.liveMeter.checked && el === els.length) updateMeterFrom('', poolSizeClassic(), Number(els.length.value || 16));
  remember();
}));

// init
switchPanels();
recall();
updateMeterFrom('', 70, 16);
</script>

</body>
</html>

<!-- 12) Instant Text Counter - TOOL PAGE HEAD (/tools) -->
<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GE98V48RK8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GE98V48RK8');
</script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "t5y2d08vd0");
</script>
  <meta name="msvalidate.01" content="A9EB890789B5C28E62629F99EEDC30A1" />
  <!-- Essentials -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <base href="/tools/">

  <!-- Primary SEO -->
  <title>Instant Text Counter - Words, Characters, Lines & Sentences | SnipText</title>
  <meta name="description" content="Count words, characters, lines and sentences instantly. Live updates, reading time and advanced metrics. Fast, accurate and privacy-friendly." />
  <meta name="keywords" content="word counter, character counter, line counter, sentence counter, text counter, reading time, no spaces character count, live word count, text analyzer, online word count" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <!-- Canonical & hreflang -->
  <link rel="canonical" href="https://checkai.pro/tools/word-counter" />
  <link rel="alternate" href="https://checkai.pro/tools/word-counter" hreflang="en" />
  <link rel="alternate" href="https://checkai.pro/tools/word-counter" hreflang="x-default" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/tools/css/free-tools.css" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="SnipText" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:title" content="Instant Text Counter - Words, Characters, Lines & Sentences" />
  <meta property="og:description" content="Live counts with reading time and advanced metrics. Private and fast in your browser." />
  <meta property="og:url" content="https://checkai.pro/tools/word-counter" />
  <meta property="og:image" content="https://checkai.pro/images/sniptext-default-tools-img" />
  <meta property="og:image:secure_url" content="https://checkai.pro/images/sniptext-default-tools-img" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="SnipText tool preview" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@SnipText" />
  <meta name="twitter:title" content="Instant Text Counter - Words, Characters, Lines & Sentences" />
  <meta name="twitter:description" content="Fast, accurate counters with live updates and reading time." />
  <meta name="twitter:image" content="https://checkai.pro/images/sniptext-default-tools-img" />

  <!-- Theme / Icons -->
  <meta name="theme-color" content="#1D4ED8" />
  <link rel="icon" href="/favicon.png" type="image/png" />
  <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Structured Data: WebApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"SnipText Word/Character/Line/Sentence Counter",
    "url":"https://checkai.pro/tools/word-counter",
    "applicationCategory":"UtilitiesApplication",
    "operatingSystem":"All",
    "isAccessibleForFree":true,
    "browserRequirements":"Requires JavaScript; works on modern browsers.",
    "featureList":[
      "Word, character, line and sentence counts",
      "Reading time and speaking time",
      "No-spaces character count",
      "Live updates and advanced metrics",
      "Copy and download"
    ],
    "screenshot":"https://checkai.pro/images/sniptext-default-tools-img",
    "publisher":{
      "@type":"Organization",
      "name":"Snip Text",
      "url":"https://checkai.pro/",
      "logo":{"@type":"ImageObject","url":"https://checkai.pro/favicon.png","width":512,"height":512}
    }
  }
  </script>

  <!-- Structured Data: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {
        "@type":"Question",
        "name":"Is the counter private?",
        "acceptedAnswer":{"@type":"Answer","text":"Yes. The tool runs locally in your browser and does not upload your text."}
      },
      {
        "@type":"Question",
        "name":"What counts as a word?",
        "acceptedAnswer":{"@type":"Answer","text":"By default words are tokens separated by whitespace. Punctuation is ignored at boundaries. You can toggle options for hyphenated items if available."}
      },
      {
        "@type":"Question",
        "name":"What is characters with and without spaces?",
        "acceptedAnswer":{"@type":"Answer","text":"Characters with spaces includes all visible characters and spaces. No-spaces excludes standard spaces and line breaks to help meet platform limits."}
      },
      {
        "@type":"Question",
        "name":"How is reading time estimated?",
        "acceptedAnswer":{"@type":"Answer","text":"Reading time is based on a common average of about 200–250 words per minute. Speaking time uses a slower rate for presentations."}
      },
      {
        "@type":"Question",
        "name":"Does it handle emojis and non-Latin scripts?",
        "acceptedAnswer":{"@type":"Answer","text":"Yes. Counting uses grapheme clusters so emojis and characters with combining marks are treated as single user-perceived characters where supported."}
      }
    ]
  }
  </script>

  <!-- Structured Data: Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://checkai.pro/"},
      {"@type":"ListItem","position":2,"name":"Free Tools","item":"https://checkai.pro/tools/free-tools"},
      {"@type":"ListItem","position":3,"name":"Word Counter","item":"https://checkai.pro/tools/word-counter"}
    ]
  }
  </script>


  <!-- Page styles (self-contained so this file is portable) -->
  <style>
/* ==========================================================
   SnipText • WORD COUNTER
   Role-model aligned • brand-aware • HTML unchanged
   (keeps your --wc-* and global brand vars)
========================================================== */

:root{
  /* Backdrop & elevation */
  --wc-bg:
    radial-gradient(1200px 520px at 8% -10%, color-mix(in oklab, var(--color-primary) 20%, transparent), transparent 60%),
    radial-gradient(900px 520px at 100% 0%, color-mix(in oklab, var(--color-accent) 16%, transparent), transparent 60%),
    linear-gradient(180deg, var(--color-bg-dark) 0%, var(--color-footer-bg) 100%);
  --wc-card:      rgba(255,255,255,0.06);
  --wc-glass:     rgba(255,255,255,0.08);
  --wc-glass-2:   rgba(255,255,255,0.03);
  --wc-border:    rgba(255,255,255,0.12);
  --wc-shadow-1:  0 16px 46px rgba(2,6,23,0.55);

  /* Accents */
  --wc-accent-a:  linear-gradient(90deg, var(--color-primary), var(--color-accent));
  --wc-accent-b:  linear-gradient(90deg, var(--gradient-cta-start), var(--gradient-cta-end)); /* blue → warm */

  /* Text */
  --wc-text:      var(--color-white);
  --wc-muted:     rgba(255,255,255,0.88);
  --wc-muted-2:   rgba(255,255,255,0.66);

  /* Status */
  --wc-ok:        #22c55e;
  --wc-warn:      var(--color-used-often);
  --wc-danger:    #ef4444;

  /* Structure */
  --wc-radius:    14px;
  --wc-radius-lg: 18px;
  --wc-maxw:      1200px;

  /* Motion */
  --wc-ease: cubic-bezier(.22,.61,.36,1);
  --wc-dur:  220ms;

  color-scheme: dark;
  font-family: 'Poppins','Roboto',system-ui,-apple-system,'Segoe UI','Helvetica Neue',Arial,sans-serif;
}

/* Light-mode polish */
@media (prefers-color-scheme: light){
  :root{
    --wc-bg:
      radial-gradient(1200px 520px at 8% -10%, color-mix(in oklab, var(--color-primary) 10%, transparent), transparent 60%),
      radial-gradient(900px 520px at 100% 0%, color-mix(in oklab, var(--color-accent) 10%, transparent), transparent 60%),
      linear-gradient(180deg, var(--color-bg-light) 0%, #ffffff 100%);
    --wc-card:#fff; --wc-glass:rgba(0,0,0,.04); --wc-glass-2:rgba(0,0,0,.02);
    --wc-border:var(--color-border);
    --wc-text:var(--color-text-dark); --wc-muted:var(--color-text-dark); --wc-muted-2:var(--color-text-light);
    --wc-shadow-1: 0 16px 46px rgba(2,6,23,.12);
  }
}

/* Base */
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  background:var(--wc-bg) fixed no-repeat;
  background-size:cover;
  color:var(--wc-text);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
a{color:inherit;text-decoration:none}
button{font-family:inherit}

/* Layout */
main#word-counter-text-counter-app{
  padding:48px 20px; min-height:72vh;
  display:flex; flex-direction:column; gap:18px; align-items:center;
}
.word-counter-hero{width:100%;max-width:var(--wc-maxw)}
.word-counter-hero-inner{
  display:grid; grid-template-columns:1fr 480px; gap:28px; align-items:start;
  border:1px solid var(--wc-border);
  border-radius:var(--wc-radius-lg);
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  backdrop-filter: blur(10px);
  padding:18px;
  box-shadow:var(--wc-shadow-1);
  animation:wc-fade .35s var(--wc-ease) both;
}
@media (max-width:980px){ .word-counter-hero-inner{grid-template-columns:1fr} }

/* Left column */
.word-counter-left{padding:6px 4px}
.word-counter-title{
  margin:0 0 6px; font-weight:800; letter-spacing:.2px;
  font-size:clamp(1.75rem,2.6vw,2.35rem); line-height:1.18;
  background:var(--wc-accent-a); -webkit-background-clip:text; background-clip:text; color:transparent;
}
.word-counter-subtitle{margin:0 0 14px; color:var(--wc-muted-2); font-size:.98rem; max-width:70ch}

/* Controls */
.word-counter-controls{
  display:flex; flex-wrap:wrap; gap:10px; margin-bottom:12px
}
.word-counter-btn{
  background:var(--wc-glass);
  padding:10px 14px; border-radius:12px; border:1px solid var(--wc-border);
  cursor:pointer; backdrop-filter:blur(6px); box-shadow:var(--wc-shadow-1);
  font-weight:600; color:var(--wc-text);
  transition: transform var(--wc-dur) var(--wc-ease),
              filter var(--wc-dur) var(--wc-ease),
              box-shadow var(--wc-dur) var(--wc-ease);
}
.word-counter-btn:hover{ transform:translateY(-2px); filter:brightness(1.06) }
.word-counter-btn:active{ transform:translateY(0) }
.word-counter-btn.word-counter-small{ padding:8px 10px; font-size:.9rem }
.word-counter-btn.word-counter-outline{
  background:transparent; border:1px solid color-mix(in oklab, #000 10%, var(--wc-border));
}
.word-counter-btn.word-counter-ghost{
  background:transparent; border:1px dashed color-mix(in oklab, #000 10%, var(--wc-border));
}

/* Stats */
.word-counter-stats-grid{
  display:grid; grid-template-columns:repeat(4,1fr); gap:14px; margin-bottom:12px;
}
@media (max-width:980px){ .word-counter-stats-grid{grid-template-columns:repeat(2,1fr)} }
.word-counter-stat-card{
  background:linear-gradient(180deg,var(--wc-glass-2),transparent);
  padding:14px; border-radius:12px;
  border:1px solid color-mix(in oklab, #000 6%, var(--wc-border));
  display:flex; flex-direction:column; gap:6px;
  transition:transform .22s var(--wc-ease), box-shadow .22s var(--wc-ease);
}
.word-counter-stat-card:hover{
  transform:translateY(-3px);
  box-shadow:0 22px 54px rgba(2,6,23,.38);
}
.word-counter-stat-icon{font-size:1.05rem}
.word-counter-stat-value{
  font-size:1.5rem; font-weight:800; letter-spacing:.2px;
  background:var(--wc-accent-a); -webkit-background-clip:text; background-clip:text; color:transparent;
}
.word-counter-stat-label{font-size:.82rem; color:var(--wc-muted-2)}

.word-counter-meta-row{
  display:flex; gap:16px; color:var(--wc-muted-2); align-items:center;
  margin-top:6px; font-size:.95rem
}
@media (max-width:520px){ .word-counter-meta-row{flex-direction:column; align-items:flex-start} }

/* Right column (textarea) */
.word-counter-right{position:relative}
textarea#word-counter-theText{
  width:100%; min-height:440px; resize:vertical; padding:18px;
  border-radius:14px;
  border:1px solid color-mix(in oklab, #000 8%, var(--wc-border));
  background:
    linear-gradient(180deg, rgba(255,255,255,.025), rgba(255,255,255,.01)),
    linear-gradient(transparent 31px, rgba(255,255,255,.04) 32px); /* subtle ruled lines */
  background-size: 100% 100%, 100% 32px;
  color:var(--wc-text); font-size:1rem; outline:none;
  box-shadow:var(--wc-shadow-1);
  transition: box-shadow var(--wc-dur) var(--wc-ease), transform 140ms var(--wc-ease);
  font-family:ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  caret-color: color-mix(in oklab, var(--color-accent) 80%, #fff);
}
textarea#word-counter-theText::placeholder{ color:var(--wc-muted-2) }
textarea#word-counter-theText:focus{
  box-shadow:0 28px 72px rgba(2,6,23,.48), 0 0 0 3px rgba(96,165,250,.20) inset;
  transform:translateY(-2px);
}
.word-counter-hint{margin-top:8px; color:var(--wc-muted-2); font-size:.92rem}
kbd{background:rgba(255,255,255,.06); border-radius:6px; padding:4px 6px; font-weight:700; border:1px solid rgba(255,255,255,.06)}

/* Advanced panels */
.word-counter-advanced{
  margin-top:18px;
  display:grid; grid-template-columns:1.1fr .9fr; gap:16px; width:100%; max-width:var(--wc-maxw);
}
@media (max-width:992px){ .word-counter-advanced{grid-template-columns:1fr} }

.wc-card{
  border:1px solid var(--wc-border); background:var(--wc-card);
  border-radius:var(--wc-radius-lg); box-shadow:var(--wc-shadow-1);
  overflow:hidden; backdrop-filter: blur(10px);
}
.wc-card-head{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 14px;
  background:linear-gradient(90deg,
      color-mix(in oklab, var(--color-primary) 14%, transparent),
      color-mix(in oklab, var(--color-accent) 10%, transparent));
  border-bottom:1px solid var(--wc-border);
}
.wc-card-title{margin:0; font-size:12px; letter-spacing:.35px; text-transform:uppercase; opacity:.9}

.wc-grid{
  padding:14px; display:grid; grid-template-columns:repeat(3,1fr); gap:10px;
}
@media (max-width:680px){ .wc-grid{grid-template-columns:1fr 1fr} }

.wc-chip{
  border:1px solid var(--wc-border); border-radius:12px; padding:10px; font-size:12px;
  background:linear-gradient(180deg, rgba(255,255,255,.03), transparent);
  display:grid; gap:4px;
  transition:transform var(--wc-dur) var(--wc-ease), box-shadow var(--wc-dur) var(--wc-ease);
}
.wc-chip:hover{ transform:translateY(-2px); box-shadow:0 12px 28px rgba(2,6,23,.30) }
.wc-chip b{color:var(--wc-muted-2); font-weight:600}
.wc-chip span{font-weight:800; font-size:18px}

.wc-goal-wrap{padding:14px; display:grid; gap:12px}
.wc-goal-row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
.wc-number{
  width:120px; text-align:center;
  padding:8px 10px; border:1px solid var(--wc-border); border-radius:10px;
  background:transparent; color:var(--wc-text); outline:none; font-size:13px;
  transition: box-shadow var(--wc-dur) var(--wc-ease), border-color var(--wc-dur) var(--wc-ease);
}
.wc-number:focus{ border-color:var(--color-accent); box-shadow:0 0 0 3px rgba(59,130,246,.18) }

.wc-progress{
  height:12px; border-radius:999px; background:rgba(255,255,255,.08);
  border:1px solid var(--wc-border); overflow:hidden; position:relative;
}
.wc-progress>i{ display:block; height:100%; width:0%; background:var(--wc-accent-b) }

.wc-top-wrap{padding:14px; display:grid; gap:12px}
.wc-top-controls{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
.wc-check{display:inline-flex; align-items:center; gap:6px; user-select:none}
.wc-list{
  display:grid; grid-template-columns:1fr auto; gap:8px 10px;
  max-height:300px; overflow:auto; padding-right:6px;
}
.wc-list small{opacity:.7}

/* A11y */
.word-counter-visually-hidden{
  position:absolute!important;height:1px;width:1px;overflow:hidden;
  clip:rect(1px,1px,1px,1px);white-space:nowrap
}

/* Focus style (global within app) */
:where(.word-counter-btn,.wc-number,textarea#word-counter-theText):focus-visible{
  outline:2px solid color-mix(in oklab, var(--color-accent) 60%, white);
  outline-offset:2px;
}

/* Scrollbars (nice but subtle) */
@supports (scrollbar-width:thin){
  #word-counter-text-counter-app *{ scrollbar-width:thin; scrollbar-color: rgba(255,255,255,.25) transparent; }
}
#word-counter-text-counter-app *::-webkit-scrollbar{ height:10px; width:10px }
#word-counter-text-counter-app *::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.25); border-radius:999px }

/* Micro motions */
@keyframes wc-fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }

.feature-card-all-pages {margin: 0 2rem;}
.tools-grid {margin: 1rem; background: #0e1730;}
.tool-card {background: #0f1b34;}
@media (max-width: 600px) { .tools-grid {margin: 1rem 0;} }
  </style>
</head>
<body>

<!-- Simple site nav (uses global styles) -->
<nav id="main-navbar" aria-label="Main navigation">
  <div class="nav-container">
    <div class="logo"><a href="/index.html">Snip Text</a></div>
    <button class="hamburger" id="hamburger" aria-expanded="false" aria-label="Open menu">
      <span></span><span></span><span></span>
    </button>

    <ul class="nav-links" id="nav-links">
      <li><a href="/index.html">Home</a></li>
      <li><a href="/tools/free-tools.html">Free Tools</a></li>
      <li><a href="/features.html">Features</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/blog/blog.html">Blog</a></li>
      <li><a href="/contact.html">Contact</a></li>
      <li><a id="nav-dashboard-link" href="/login.html">Dashboard</a></li>
      <li><a id="nav-logout-link" href="#" style="display:none;">Logout</a></li>
    </ul>
  </div>
</nav>

<main id="word-counter-text-counter-app" aria-label="Text counter application">
  <section class="word-counter-hero" aria-hidden="false">
    <div class="word-counter-hero-inner">
      <!-- LEFT: heading, controls, stats -->
      <div class="word-counter-left">
        <h1 class="word-counter-title">Instant Text Counter</h1>
        <p class="word-counter-subtitle">Word, character, line & sentence counts - live, accurate, and privacy-friendly. Plus advanced insights for editors, students, and creators.</p>

        <div class="word-counter-controls" role="toolbar" aria-label="Tool actions">
          <button id="word-counter-sampleBtn" class="word-counter-btn" title="Load sample text">Load sample</button>
          <button id="word-counter-copyBtn" class="word-counter-btn word-counter-outline" title="Copy text to clipboard">Copy</button>
          <button id="word-counter-clearBtn" class="word-counter-btn word-counter-ghost" title="Clear textarea">Clear</button>
          <button id="word-counter-downloadBtn" class="word-counter-btn word-counter-small" title="Download as .txt">Download .txt</button>
          <button id="word-counter-cleanBtn" class="word-counter-btn word-counter-small" title="Normalize whitespace">Normalize</button>
          <label class="word-counter-btn word-counter-small" title="Import .txt" style="cursor:pointer;">
            Import .txt<input id="word-counter-import" type="file" accept=".txt" hidden>
          </label>
        </div>

        <div class="word-counter-stats-grid" role="region" aria-live="polite" aria-atomic="true" aria-label="Text statistics">
          <div class="word-counter-stat-card">
            <div class="word-counter-stat-icon" aria-hidden>✍️</div>
            <div class="word-counter-stat-value" id="word-counter-words">0</div>
            <div class="word-counter-stat-label">Words</div>
          </div>

          <div class="word-counter-stat-card">
            <div class="word-counter-stat-icon" aria-hidden>🔡</div>
            <div class="word-counter-stat-value" id="word-counter-characters">0</div>
            <div class="word-counter-stat-label">Characters</div>
          </div>

          <div class="word-counter-stat-card">
            <div class="word-counter-stat-icon" aria-hidden>📄</div>
            <div class="word-counter-stat-value" id="word-counter-lines">0</div>
            <div class="word-counter-stat-label">Lines</div>
          </div>

          <div class="word-counter-stat-card">
            <div class="word-counter-stat-icon" aria-hidden>📣</div>
            <div class="word-counter-stat-value" id="word-counter-sentences">0</div>
            <div class="word-counter-stat-label">Sentences</div>
          </div>
        </div>

        <div class="word-counter-meta-row">
          <div>Est. reading: <strong id="word-counter-readingTime">0</strong> <span class="word-counter-muted">min</span></div>
          <div>Chars (no spaces): <strong id="word-counter-charsNoSpaces">0</strong></div>
        </div>
      </div>

      <!-- RIGHT: textarea -->
      <div class="word-counter-right">
        <label for="word-counter-theText" class="word-counter-visually-hidden">Enter or paste text</label>
        <textarea id="word-counter-theText" placeholder="Paste or type your text here - stats update live…" spellcheck="true" autocomplete="off" aria-label="Text input"></textarea>
        <p class="word-counter-hint">Tip: press <kbd>Ctrl</kbd>/<kbd>⌘</kbd> + <kbd>K</kbd> to clear.</p>
      </div>
    </div>

    <!-- ADVANCED SECTION -->
    <div class="word-counter-advanced">
      <!-- Insights -->
      <section class="wc-card" aria-labelledby="wc-insights-title">
        <div class="wc-card-head">
          <h2 id="wc-insights-title" class="wc-card-title">Insights</h2>
          <div class="word-counter-muted">Live metrics</div>
        </div>
        <div class="wc-grid">
          <div class="wc-chip"><b>Paragraphs</b><span id="word-counter-paragraphs">0</span></div>
          <div class="wc-chip"><b>Unique words</b><span id="word-counter-uniqueWords">0</span></div>
          <div class="wc-chip"><b>Vocab density</b><span id="word-counter-vocabDensity">0</span></div>
          <div class="wc-chip"><b>Avg word length</b><span id="word-counter-avgWordLen">0</span></div>
          <div class="wc-chip"><b>Avg sentence (w)</b><span id="word-counter-avgSentLen">0</span></div>
          <div class="wc-chip"><b>Speaking time</b><span id="word-counter-speakingTime">0s</span></div>
          <div class="wc-chip"><b>Slow read (125wpm)</b><span id="word-counter-slowReading">0s</span></div>
          <div class="wc-chip"><b>Fast read (300wpm)</b><span id="word-counter-fastReading">0s</span></div>
          <div class="wc-chip"><b>Reading ease</b><span id="word-counter-readingEase">0</span></div>
          <div class="wc-chip"><b>Grade level</b><span id="word-counter-gradeLevel">0</span></div>
          <div class="wc-chip"><b>Longest word</b><span id="word-counter-longestWord"></span></div>
          <div class="wc-chip"><b>Shortest word</b><span id="word-counter-shortestWord"></span></div>
        </div>
      </section>

      <!-- Goals -->
      <section class="wc-card" aria-labelledby="wc-goal-title">
        <div class="wc-card-head">
          <h2 id="wc-goal-title" class="wc-card-title">Goal & Export</h2>
          <div class="word-counter-muted">Targets & reports</div>
        </div>
        <div class="wc-goal-wrap">
          <div class="wc-goal-row">
            <label for="word-counter-goal" class="word-counter-visually-hidden">Target words</label>
            <input id="word-counter-goal" class="wc-number" type="number" min="0" step="50" value="1000" aria-label="Target words">
            <span id="word-counter-goalLabel" class="word-counter-muted">Target: 1,000 words</span>
            <button id="word-counter-exportCsv" class="word-counter-btn word-counter-small">Export CSV</button>
            <button id="word-counter-exportJson" class="word-counter-btn word-counter-small word-counter-outline">Export JSON</button>
          </div>
          <div class="wc-progress" aria-label="Goal progress" aria-live="polite">
            <i id="word-counter-goalbar" style="width:0%"></i>
          </div>
        </div>

        <div class="wc-top-wrap">
          <div class="wc-top-controls">
            <div class="wc-check">
              <input type="checkbox" id="word-counter-excludeStop" checked>
              <label for="word-counter-excludeStop">Exclude stopwords</label>
            </div>
            <label>Min length
              <input id="word-counter-minLen" class="wc-number" type="number" min="1" max="12" value="3">
            </label>
            <label>Top N
              <input id="word-counter-topN" class="wc-number" type="number" min="5" max="50" value="15">
            </label>
          </div>
          <div class="wc-list" id="word-counter-topWords" aria-live="polite" aria-label="Top words list">
            <!-- Filled by script -->
          </div>
        </div>
      </section>
    </div>
  </section>

  <div class="free-tools-guide">
    <p class="free-tools-guide-p">See Word Counter Guide on SnipText Blog Page <a href="/blog/word-character-line-sentence-counter-blog.html" class="free-tools-blog-link">here</a>.</p>
  </div>

</main>

  <!-- TOOLS GRID -->
       <div class="feature-card-all-pages">
        <h1 class="feature-card-all-pages-para">Featured Tools</h1>
       </div>
  <section id="tools-grid" class="tools-grid" aria-label="Tools list">
    <!-- Tool cards - 10 items -->

    <article class="tool-card" tabindex="0" data-href="/tools/case-converter.html" aria-labelledby="t2">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M4 20h16M8 4l4 8 4-8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t2" class="card-title">Case Converter</h3>
      <p class="card-desc">Switch between uppercase, lowercase, sentence case, title case and alternating case with one click.</p>
      <a class="card-cta" href="/tools/case-converter.html" aria-label="Open Case Converter">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/remove-empty-lines.html" aria-labelledby="t9">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M4 7h16M4 12h10M4 17h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t9" class="card-title">Remove Empty Lines</h3>
      <p class="card-desc">Quickly strip blank lines, collapse multi-line gaps, and optionally trim each line.</p>
      <a class="card-cta" href="/tools/remove-empty-lines.html" aria-label="Open Remove Empty Lines">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/whitespace-and-formatting-cleaner.html" aria-labelledby="t4">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M3 7h18M8 11h8M6 15h12M4 19h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t4" class="card-title">Whitespace & Formatting Cleaner</h3>
      <p class="card-desc">Trim whitespace, normalize newlines, remove extra spaces, and fix inconsistent indentation.</p>
      <a class="card-cta" href="/tools/whitespace-and-formatting-cleaner.html" aria-label="Open Whitespace & Formatting Cleaner">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/duplicate-word-finder.html" aria-labelledby="t3">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M3 7h8v10H3zM13 3h8v10h-8z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t3" class="card-title">Duplicate Word Finder</h3>
      <p class="card-desc">Find repeated words and common duplicates, with options to highlight or remove them automatically.</p>
      <a class="card-cta" href="/tools/duplicate-word-finder.html" aria-label="Open Duplicate Word Finder">Open →</a>
    </article>

  </section>

<footer id="main-footer" class="site-footer" aria-labelledby="footer-heading">
  <!-- decorative background -->
  <div class="footer-bg" aria-hidden="true"></div>

  <div class="footer-container">
    <div class="footer-logo">
      <h2 id="footer-heading" class="footer-brand">Snip Text</h2>
      <p>Empowering better writing, one tool at a time.</p>
    </div>

    <nav class="footer-links" aria-label="Footer links">
      <a href="feedback.html">Feedback</a>
      <a href="contact.html#contact">Contact Us</a>
      <a href="privacy-policy.html">Privacy Policy</a>
      <a href="terms-of-use.html">Terms of Use</a>
    </nav>

    <div class="footer-bottom">
      <p>
        &copy; <span id="year"></span>
        <span class="powered-by">
          Snip Text - powered by
          <a href="https://checkai.pro" target="_blank" rel="noopener">CheckAI.pro</a>
        </span>
        · All rights reserved.
      </p>
    </div>
  </div>

  <!-- back to top -->
  <button class="to-top" id="to-top" aria-label="Back to top">
    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
      <path d="M12 5l-6 6m6-6l6 6M12 5v14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
    </svg>
  </button>
</footer>

<!-- keep global behavioral scripts (if your project requires them) -->
<script src="/js/index.js"></script>
<script src="/js/auth.js"></script>
<script src="/tools/js/free-tools.js"></script>

<!-- FAQs script for SEO -->
 <script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"FAQPage",
  "mainEntity":[
    {
      "@type":"Question",
      "name":"Is the Word Counter private?",
      "acceptedAnswer":{"@type":"Answer","text":"Yes. Counting happens client-side; we don’t upload your text to our servers."}
    },
    {
      "@type":"Question",
      "name":"How accurate is character counting with emojis?",
      "acceptedAnswer":{"@type":"Answer","text":"We count Unicode code points, so emojis and multi-byte characters are handled correctly."}
    },
    {
      "@type":"Question",
      "name":"Can I estimate speaking time?",
      "acceptedAnswer":{"@type":"Answer","text":"Yes. We show reading and speaking times using common WPM baselines."}
    }
  ]
}
</script>


<!-- Page script (optimized, commented) -->
<script>
(function () {
  'use strict';

  // ---- Grab elements (guarded) ----
  const ta                 = document.getElementById('word-counter-theText');
  if (!ta) return;

  const wordsEl            = document.getElementById('word-counter-words');
  const charsEl            = document.getElementById('word-counter-characters');
  const linesEl            = document.getElementById('word-counter-lines');
  const sentencesEl        = document.getElementById('word-counter-sentences');
  const readingEl          = document.getElementById('word-counter-readingTime');
  const charsNoSpacesEl    = document.getElementById('word-counter-charsNoSpaces');

  // Advanced metric nodes
  const paragraphsEl       = document.getElementById('word-counter-paragraphs');
  const uniqueWordsEl      = document.getElementById('word-counter-uniqueWords');
  const vocabDensityEl     = document.getElementById('word-counter-vocabDensity');
  const avgWordLenEl       = document.getElementById('word-counter-avgWordLen');
  const avgSentLenEl       = document.getElementById('word-counter-avgSentLen');
  const speakTimeEl        = document.getElementById('word-counter-speakingTime');
  const slowReadEl         = document.getElementById('word-counter-slowReading');
  const fastReadEl         = document.getElementById('word-counter-fastReading');
  const longestWordEl      = document.getElementById('word-counter-longestWord');
  const shortestWordEl     = document.getElementById('word-counter-shortestWord');
  const readingEaseEl      = document.getElementById('word-counter-readingEase');
  const gradeLevelEl       = document.getElementById('word-counter-gradeLevel');

  // Top words & options
  const topWrap            = document.getElementById('word-counter-topWords');
  const excludeStopCk      = document.getElementById('word-counter-excludeStop');
  const minLenInput        = document.getElementById('word-counter-minLen');
  const topNInput          = document.getElementById('word-counter-topN');

  // Goal & export
  const goalInput          = document.getElementById('word-counter-goal');
  const goalLabel          = document.getElementById('word-counter-goalLabel');
  const goalBar            = document.getElementById('word-counter-goalbar');
  const exportCsvBtn       = document.getElementById('word-counter-exportCsv');
  const exportJsonBtn      = document.getElementById('word-counter-exportJson');

  // Buttons
  const sampleBtn          = document.getElementById('word-counter-sampleBtn');
  const clearBtn           = document.getElementById('word-counter-clearBtn');
  const copyBtn            = document.getElementById('word-counter-copyBtn');
  const downloadBtn        = document.getElementById('word-counter-downloadBtn');
  const cleanBtn           = document.getElementById('word-counter-cleanBtn');
  const importInput        = document.getElementById('word-counter-import');

  // Decorative: year & simple back-to-top
  const yearSpan           = document.getElementById('year');
  if (yearSpan) yearSpan.textContent = new Date().getFullYear();

  // ---- Helpers ----
  const prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  const setText = (el, v) => { if (el) el.textContent = v; };
  const clamp = (v, lo, hi) => Math.min(hi, Math.max(lo, v));

  // Animation for counters
  function animateTo(el, from, to, decimals = 0) {
    if (!el) return;
    if (prefersReducedMotion) {
      el.textContent = decimals ? Number(to).toFixed(decimals) : String(Math.round(to));
      return;
    }
    const duration = 420;
    const start = performance.now();
    const delta = to - from;
    const format = (v) => decimals ? v.toFixed(decimals) : String(Math.round(v));
    function step(now) {
      const t = Math.min(1, (now - start) / duration);
      const eased = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
      const value = from + delta * eased;
      el.textContent = format(value);
      if (t < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }

  // Regex support
  let unicodePropsOK = true;
  try { new RegExp('\\p{L}', 'u'); } catch { unicodePropsOK = false; }
  const whiteSpaceRe = unicodePropsOK ? /\p{White_Space}/gu : /\s/g;
  const wordTokenRe = unicodePropsOK
    ? /[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]|[\p{L}\p{N}]+(?:['’\--‒–-][\p{L}\p{N}]+)*/gu
    : /[A-Za-z0-9]+(?:['’\-][A-Za-z0-9]+)*/g;

  // Sentence split heuristics
  const abbrevRe = /\b(?:mr|mrs|ms|dr|prof|sr|jr|vs|etc|e\.g|i\.e|ph\.?d|u\.s|u\.k|a\.m|p\.m)\.$/i;
  const initialsRe = /(?:\b[A-Z]\.){2,}$/;

  function countSentences(text) {
    const normalized = text.replace(/\u2026/g, '...').replace(/(\r\n|\r|\n)+/g, ' ').trim();
    if (!normalized) return 0;
    const chunks = normalized.match(/[^.!?。！？]+[.!?。！？]+(?=\s|$)/g) || [];
    const filtered = chunks.filter(seg => {
      const t = seg.trim();
      return !(abbrevRe.test(t) || initialsRe.test(t));
    });
    if (filtered.length === 0 && normalized) return 1;
    return filtered.length;
  }

  function countLines(text) {
    if (text.length === 0) return 0;
    const nl = text.match(/\r\n|\r|\n/g);
    return (nl ? nl.length : 0) + 1;
  }

  // Syllable heuristic (English-ish). Good enough for readability indexes.
  function syllables(word) {
    if (!word) return 0;
    const w = String(word).toLowerCase().replace(/[^a-z]/g, '');
    if (!w) return 0;
    // Quick exceptions
    if (/(?:cia|tia|cius|cious|geous|ion|sia|.ely)$/.test(w)) {}
    let syl = 0;
    const vowels = 'aeiouy';
    let prevVowel = false;
    for (let i = 0; i < w.length; i++) {
      const isVowel = vowels.includes(w[i]);
      if (isVowel && !prevVowel) syl++;
      prevVowel = isVowel;
    }
    // Silent 'e'
    if (w.endsWith('e')) syl--;
    // Minimum 1
    return Math.max(1, syl);
  }

  // Stopword set (English minimal, extendable)
  const STOPWORDS = new Set([
    'the','a','an','and','or','but','if','then','else','when','at','by','for','in','of','on','to','up','as','is','it','its','be','are','was','were','this','that','these','those','with','from','your','you','i','we','they','he','she','them','his','her','our','us','their','my','me','not','no'
  ]);

  // Durations & formatting
  const secs = (m) => Math.max(0, Math.round(m));
  const formatHM = (seconds) => {
    seconds = Math.max(0, Math.round(seconds));
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return m > 0 ? `${m}m ${s}s` : `${s}s`;
  };

  // Core counting
  function countAll(text) {
    const codepoints = Array.from(text);
    const chars = codepoints.length;

    const charsNoSpaces = unicodePropsOK
      ? codepoints.filter(ch => !whiteSpaceRe.test(ch)).length
      : text.replace(/\s+/g, '').length;

    const wordMatches = text.match(wordTokenRe);
    const words = wordMatches ? wordMatches.length : (text.trim() ? text.trim().split(/\s+/).filter(Boolean).length : 0);

    const sentences = countSentences(text);
    const lines = countLines(text);

    const wpmNormal = 200, wpmSlow = 125, wpmFast = 300, wpmSpeak = 130;

    const readingMinutes = words > 0 ? (words / wpmNormal) : 0;
    const slowSeconds    = Math.round((words / wpmSlow)  * 60);
    const fastSeconds    = Math.round((words / wpmFast)  * 60);
    const speakSeconds   = Math.round((words / wpmSpeak) * 60);

    const paraBlocks = text.split(/\n{2,}/).map(s => s.trim()).filter(Boolean);
    const paragraphs = paraBlocks.length || (text.trim() ? 1 : 0);

    // Averages & vocab stats
    let avgWordLen = 0, avgSentLen = 0, uniqueCount = 0, density = 0, longest = '', shortest = '', totalSyll = 0;
    if (words > 0 && wordMatches) {
      const normalizedWords = wordMatches.map(w => w.toLocaleLowerCase());
      const set = new Set(normalizedWords);
      uniqueCount = set.size;
      density = +(uniqueCount / words).toFixed(3);

      const lens = normalizedWords.map(w => Array.from(w).length);
      const totalLen = lens.reduce((a, b) => a + b, 0);
      avgWordLen = +(totalLen / words).toFixed(2);

      normalizedWords.forEach(w => {
        const l = Array.from(w).length;
        if (!longest || l > Array.from(longest).length) longest = w;
        if (!shortest || l < Array.from(shortest).length) shortest = w;
        totalSyll += syllables(w);
      });

      avgSentLen = sentences > 0 ? +(words / sentences).toFixed(2) : words;
    }

    // Readability indices (FK + Flesch)
    let readingEase = 0, fkGrade = 0;
    if (words > 0 && sentences > 0) {
      const W = words, S = sentences, Sy = totalSyll;
      readingEase = +(206.835 - 1.015*(W/S) - 84.6*(Sy/W)).toFixed(1);     // 0–100 (higher easier)
      fkGrade    = +(0.39*(W/S) + 11.8*(Sy/W) - 15.59).toFixed(1);         // grade level
      if (!isFinite(readingEase)) readingEase = 0;
      if (!isFinite(fkGrade)) fkGrade = 0;
    }

    return {
      words, chars, lines, sentences, charsNoSpaces,
      readingMinutes, slowSeconds, fastSeconds, speakSeconds,
      paragraphs, uniqueCount, density, avgWordLen, avgSentLen,
      longest, shortest, readingEase, fkGrade,
      wordMatches: wordMatches || []
    };
  }

  // Top words (frequency)
  function topWords(tokens, opts) {
    const minLen = clamp(+opts.minLen || 1, 1, 32);
    const topN   = clamp(+opts.topN || 15, 1, 200);
    const excludeStop = !!opts.excludeStop;

    const freq = new Map();
    tokens.forEach(w => {
      const lw = w.toLocaleLowerCase();
      // Keep alphanum words for frequency viz; ignore single CJK glyphs here (optional)
      const wordLen = Array.from(lw).length;
      if (wordLen < minLen) return;
      if (excludeStop && STOPWORDS.has(lw)) return;
      // Ignore pure numbers
      if (/^\d+$/.test(lw)) return;
      freq.set(lw, (freq.get(lw) || 0) + 1);
    });

    const sorted = [...freq.entries()].sort((a,b) => b[1] - a[1]).slice(0, topN);
    return sorted; // [ [word, count], ... ]
  }

  function renderTop(list) {
    if (!topWrap) return;
    topWrap.innerHTML = '';
    if (list.length === 0) {
      const p = document.createElement('p');
      p.className = 'word-counter-muted';
      p.textContent = 'No frequent words to show yet.';
      topWrap.appendChild(p);
      return;
    }
    list.forEach(([w, c]) => {
      const label = document.createElement('div'); label.textContent = w;
      const val = document.createElement('div'); val.innerHTML = `<small>${c}</small>`;
      topWrap.appendChild(label); topWrap.appendChild(val);
    });
  }

  // Keep last values so animateTo can tween smoothly
  let last = { words: 0, chars: 0, lines: 0, sentences: 0, charsNoSpaces: 0, readingMinutes: 0 };

  // Main updater
  function updateCounts() {
    const t = ta.value || '';
    const next = countAll(t);

    // Animate core metrics
    animateTo(wordsEl,         last.words,         next.words,           0);
    animateTo(charsEl,         last.chars,         next.chars,           0);
    animateTo(linesEl,         last.lines,         next.lines,           0);
    animateTo(sentencesEl,     last.sentences,     next.sentences,       0);
    animateTo(charsNoSpacesEl, last.charsNoSpaces, next.charsNoSpaces,   0);
    animateTo(readingEl,       last.readingMinutes,Number(next.readingMinutes.toFixed(1)), 1);

    // Advanced (plain set)
    setText(paragraphsEl,  String(next.paragraphs));
    setText(uniqueWordsEl, String(next.uniqueCount));
    setText(vocabDensityEl, next.density ? next.density.toString() : '0');
    setText(avgWordLenEl,   next.avgWordLen ? next.avgWordLen.toString() : '0');
    setText(avgSentLenEl,   next.avgSentLen ? next.avgSentLen.toString() : '0');
    setText(speakTimeEl,    formatHM(next.speakSeconds));
    setText(slowReadEl,     formatHM(next.slowSeconds));
    setText(fastReadEl,     formatHM(next.fastSeconds));
    setText(longestWordEl,  next.longest || '');
    setText(shortestWordEl, next.shortest || '');
    setText(readingEaseEl,  next.readingEase.toString());
    setText(gradeLevelEl,   next.fkGrade.toString());

    // Goal
    updateGoal(next.words);

    // Top words
    renderTop(topWords(next.wordMatches, {
      minLen: +minLenInput.value || 3,
      topN: +topNInput.value || 15,
      excludeStop: !!(excludeStopCk && excludeStopCk.checked)
    }));

    // Save last for animation
    last = {
      words: next.words,
      chars: next.chars,
      lines: next.lines,
      sentences: next.sentences,
      charsNoSpaces: next.charsNoSpaces,
      readingMinutes: Number(next.readingMinutes.toFixed(1))
    };
  }

  // Goal logic
  function formatNum(n){ return (n||0).toLocaleString(); }
  function updateGoal(currentWords) {
    if (!goalInput || !goalBar || !goalLabel) return;
    const target = Math.max(0, parseInt(goalInput.value || '0', 10));
    goalLabel.textContent = `Target: ${formatNum(target)} words`;
    const pct = target > 0 ? clamp((currentWords / target) * 100, 0, 100) : 0;
    goalBar.style.width = `${pct}%`;
    goalBar.parentElement.setAttribute('aria-valuenow', String(Math.round(pct)));
    // warm up when done
    goalBar.style.filter = pct >= 100 ? 'saturate(1.2)' : 'none';
  }

  // ---- Persistence ----
  const LS_KEY = 'sniptext_word_counter_text';
  try { const saved = localStorage.getItem(LS_KEY); if (saved != null) ta.value = saved; } catch(_) {}
  const persistSoon = () => { try { localStorage.setItem(LS_KEY, ta.value || ''); } catch(_) {} };

  // ---- Initial render ----
  updateCounts();

  // ---- Real-time updates with a small debounce ----
  let typingTimer = null;
  ta.addEventListener('input', () => {
    if (typingTimer) clearTimeout(typingTimer);
    typingTimer = setTimeout(() => { updateCounts(); persistSoon(); }, 70);
  });

  // ---- Buttons ----
  if (sampleBtn) sampleBtn.addEventListener('click', () => {
    ta.value = "Paste your text here and get instant counts.\n\n• Words, characters (with / without spaces)\n• Lines and sentences\n• Reading time, grade level, top words and more\n\nSnip Text keeps it fast, accurate, and private.";
    updateCounts(); ta.focus(); persistSoon();
  });

  if (clearBtn) clearBtn.addEventListener('click', () => {
    ta.value = ''; updateCounts(); ta.focus(); persistSoon();
  });

  if (copyBtn) copyBtn.addEventListener('click', async () => {
    const prior = copyBtn.textContent;
    try {
      if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(ta.value || '');
      } else {
        const helper = document.createElement('textarea');
        helper.value = ta.value || '';
        helper.setAttribute('readonly','');
        helper.style.position = 'absolute'; helper.style.left = '-9999px';
        document.body.appendChild(helper); helper.select(); document.execCommand('copy'); helper.remove();
      }
      copyBtn.textContent = 'Copied!';
    } catch { copyBtn.textContent = 'Copy failed'; }
    setTimeout(() => (copyBtn.textContent = prior), 900);
  });

  if (downloadBtn) downloadBtn.addEventListener('click', () => {
    const bom = '\uFEFF';
    const blob = new Blob([bom, ta.value || ''], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    const yyyy = new Date().toISOString().slice(0, 10);
    a.href = url; a.download = `snip-text-${yyyy}.txt`;
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  if (cleanBtn) cleanBtn.addEventListener('click', () => {
    const s = (ta.value || '')
      .replace(/[ \t]+/g, ' ')
      .replace(/ *\n+/g, '\n')
      .replace(/\n{3,}/g, '\n\n')
      .trim();
    ta.value = s; updateCounts(); persistSoon();
  });

  if (importInput) importInput.addEventListener('change', () => {
    const f = importInput.files && importInput.files[0];
    if (!f) return;
    const reader = new FileReader();
    reader.onload = () => { ta.value = String(reader.result || ''); updateCounts(); persistSoon(); };
    reader.readAsText(f, 'utf-8');
    importInput.value = '';
  });

  // Goal & top words options
  if (goalInput) goalInput.addEventListener('input', () => updateGoal(last.words));
  [excludeStopCk, minLenInput, topNInput].forEach(el => el && el.addEventListener('input', updateCounts));

  // Export
  function statsSnapshot(){
    return {
      words: +wordsEl.textContent || 0,
      characters: +charsEl.textContent || 0,
      lines: +linesEl.textContent || 0,
      sentences: +sentencesEl.textContent || 0,
      charsNoSpaces: +charsNoSpacesEl.textContent || 0,
      readingMinutes: readingEl.textContent,
      paragraphs: +(paragraphsEl?.textContent || 0),
      uniqueWords: +(uniqueWordsEl?.textContent || 0),
      vocabDensity: +(vocabDensityEl?.textContent || 0),
      avgWordLen: +(avgWordLenEl?.textContent || 0),
      avgSentLen: +(avgSentLenEl?.textContent || 0),
      speakingTime: speakTimeEl?.textContent || '',
      slowReading: slowReadEl?.textContent || '',
      fastReading: fastReadEl?.textContent || '',
      readingEase: +(readingEaseEl?.textContent || 0),
      gradeLevel: +(gradeLevelEl?.textContent || 0)
    };
  }
  function downloadBlob(text, filename, mime='text/plain'){
    const blob = new Blob([text], {type: mime});
    const url = URL.createObjectURL(blob); const a = document.createElement('a');
    a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  }
  if (exportJsonBtn) exportJsonBtn.addEventListener('click', () => {
    const data = { snapshot: statsSnapshot(), topWords: Array.from(document.querySelectorAll('#word-counter-topWords > div:nth-child(odd)')).map((el, i) => {
      const word = el.textContent || '';
      const countEl = el.nextElementSibling?.querySelector('small');
      const count = countEl ? +countEl.textContent : 0;
      return { word, count };
    }) };
    downloadBlob(JSON.stringify(data, null, 2), 'snip-text-report.json', 'application/json');
  });
  if (exportCsvBtn) exportCsvBtn.addEventListener('click', () => {
    const snap = statsSnapshot();
    const rows = [
      ['Metric','Value'],
      ['Words', snap.words],
      ['Characters', snap.characters],
      ['Lines', snap.lines],
      ['Sentences', snap.sentences],
      ['Characters (no spaces)', snap.charsNoSpaces],
      ['Reading (minutes)', snap.readingMinutes],
      ['Paragraphs', snap.paragraphs],
      ['Unique words', snap.uniqueWords],
      ['Vocabulary density', snap.vocabDensity],
      ['Average word length', snap.avgWordLen],
      ['Average sentence length', snap.avgSentLen],
      ['Speaking time', snap.speakingTime],
      ['Slow read', snap.slowReading],
      ['Fast read', snap.fastReading],
      ['Reading ease', snap.readingEase],
      ['Grade level', snap.gradeLevel]
    ];
    const top = Array.from(document.querySelectorAll('#word-counter-topWords > div:nth-child(odd)')).map((el, i) => {
      const word = el.textContent || '';
      const countEl = el.nextElementSibling?.querySelector('small');
      const count = countEl ? +countEl.textContent : 0;
      return [word, count];
    });
    if (top.length) {
      rows.push([], ['Top words','Count'], ...top);
    }
    const csv = rows.map(r => r.map(x => `"${String(x).replace(/"/g,'""')}"`).join(',')).join('\n');
    downloadBlob(csv, 'snip-text-report.csv', 'text/csv');
  });
})();
</script>

</body>
</html>

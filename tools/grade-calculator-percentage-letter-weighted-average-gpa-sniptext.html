<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GE98V48RK8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GE98V48RK8');
</script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "t5y2d08vd0");
</script>
  <meta name="msvalidate.01" content="A9EB890789B5C28E62629F99EEDC30A1" />
  <!-- Essentials -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Primary SEO -->
  <title>Grade Calculator - Percentage to Letter Grades, Weighted Average & GPA | SnipText</title>
  <meta name="description" content="Free Grade Calculator by SnipText. Convert percentages to letter grades, compute weighted averages across categories, drop lowest scores, run what-if scenarios, and estimate required finals. Export JSON/CSV. Private, in-browser." />
  <meta name="author" content="Muhammad Waris" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <!-- Canonical (extension-less) -->
  <link rel="canonical" href="https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext" />
  <link rel="alternate" href="https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext" hreflang="en" />
  <link rel="alternate" href="https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext" hreflang="x-default" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/style.css?v=reset1" />
  <link rel="stylesheet" href="/tools/css/free-tools.css?v=reset1" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="SnipText" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:title" content="Grade Calculator - Percentage to Letter Grades, Weighted Average & GPA" />
  <meta property="og:description" content="Enter grades and weights to get your overall percentage, letter grade, and GPA. Drop lowest scores, simulate finals, and export results. Runs locally in your browser." />
  <meta property="og:url" content="https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext" />
  <meta property="og:image" content="https://checkai.pro/images/sniptext-blog-default-image" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="SnipText Grade Calculator UI showing weighted categories and letter grade" />

  <!-- Theme / Icons -->
  <meta name="theme-color" content="#1D4ED8" />
  <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" />
  <link rel="icon" href="/favicon.png" type="image/png" />

  <!-- Fonts & Global CSS (kept same includes as site) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Structured Data: Organization + WebSite -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"SnipText",
    "url":"https://checkai.pro/",
    "logo":"https://checkai.pro/favicon.png",
    "sameAs":["https://www.linkedin.com","https://twitter.com"]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"SnipText",
    "url":"https://checkai.pro/",
    "potentialAction":{"@type":"SearchAction","target":"https://checkai.pro/search?q={query}","query-input":"required name=query"}
  }
  </script>

  <!-- Structured Data: WebApplication (tool details; extension-less URLs) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"SnipText Grade Calculator",
    "url":"https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext",
    "applicationCategory":"EducationalApplication",
    "operatingSystem":"All",
    "isAccessibleForFree":true,
    "browserRequirements":"Requires JavaScript; works on modern browsers.",
    "featureList":[
      "Weighted average across categories",
      "Custom letter grade scale with A+ to F",
      "Drop lowest scores per category",
      "What-if simulator for upcoming exams",
      "Target grade - required score calculator",
      "GPA estimate on 4.0 scale",
      "CSV and JSON import/export",
      "Local-first - runs in your browser"
    ],
    "screenshot":"https://checkai.pro/images/sniptext-blog-default-image",
    "publisher":{
      "@type":"Organization",
      "name":"SnipText",
      "url":"https://checkai.pro/",
      "logo":{"@type":"ImageObject","url":"https://checkai.pro/favicon.png","width":512,"height":512}
    }
  }
  </script>

  <!-- Structured Data: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Is my grade data uploaded anywhere?","acceptedAnswer":{"@type":"Answer","text":"No. The Grade Calculator runs locally in your browser. Your data stays on your device."}},
      {"@type":"Question","name":"Can I change the letter grade boundaries?","acceptedAnswer":{"@type":"Answer","text":"Yes. Edit the thresholds for A+, A, A-, and so on. The scale validates order and updates instantly."}},
      {"@type":"Question","name":"How do weighted categories work?","acceptedAnswer":{"@type":"Answer","text":"Each category contributes according to its weight percentage. If weights do not sum to 100, you can normalize or adjust them."}},
      {"@type":"Question","name":"Can I drop lowest scores in a category?","acceptedAnswer":{"@type":"Answer","text":"Yes. Set the number of lowest items to drop. Drops are recalculated each time you edit scores."}},
      {"@type":"Question","name":"How do I know the score needed on my final?","acceptedAnswer":{"@type":"Answer","text":"Use the Target section. Enter your desired course grade and the weight of remaining items to see the required percentage."}}
    ]
  }
  </script>

  <!-- Structured Data: BreadcrumbList (extension-less) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://checkai.pro/"},
      {"@type":"ListItem","position":2,"name":"Tools","item":"https://checkai.pro/tools"},
      {"@type":"ListItem","position":3,"name":"Grade Calculator","item":"https://checkai.pro/tools/grade-calculator-percentage-letter-weighted-average-gpa-sniptext"}
    ]
  }
  </script>

  <!-- Compatibility -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <style>
/* =========================
   Brand tokens (kept, slightly tuned)
   ========================= */
:root{
  --color-primary:#1D4ED8;
  --color-accent:#3B82F6;
  --color-bg-light:#F3F4F6;
  --color-bg-dark:#0F172A;
  --color-white:#ffffff;
  --color-text-dark:#1F2937;
  --color-text-light:#E5E7EB;
  --color-border:rgba(255,255,255,.14);
  --color-used-often:#e85d27;
  --color-footer-bg:#1d1f2f;

  --gradient-cta-end:#ff7c4c;

  --font-heading:'Poppins','Segoe UI',system-ui,-apple-system,Roboto,'Helvetica Neue',Arial,sans-serif;
  --font-body:'Roboto','Poppins','Segoe UI',system-ui,-apple-system,'Helvetica Neue',Arial,sans-serif;

  /* Page aurora like model */
  --gc-aurora-1: color-mix(in oklab, var(--color-primary) 26%, transparent);
  --gc-aurora-2: color-mix(in oklab, var(--color-accent) 22%, transparent);
  --gc-aurora-3: color-mix(in oklab, var(--gradient-cta-end) 12%, transparent);

  --radius-xl:20px;
  --radius-lg:18px;
  --radius-md:12px;

  --shadow-1:0 10px 30px rgba(0,0,0,.35);
  --shadow-2:0 18px 48px rgba(17,24,39,.46);
}

/* =========================
   Global base + aurora background
   ========================= */
body.grade-calc-page,
body{
  margin:0;
  background: var(--color-bg-dark);
  color: var(--color-white);
  font-family: var(--font-body);
}
body::before{
  content:"";
  position: fixed; inset:0; z-index:-2;
  background:
    radial-gradient(1200px 600px at 10% -10%, var(--gc-aurora-1), transparent 60%),
    radial-gradient(900px 500px at 100% 0%,  var(--gc-aurora-2), transparent 52%),
    radial-gradient(800px 520px at 0% 100%, var(--gc-aurora-3), transparent 58%),
    linear-gradient(180deg, var(--color-bg-dark) 0%, #0b1225 100%);
}

/* =========================
   Page container width
   ========================= */
.grade-calc-container{ width:min(1200px,92vw); margin: clamp(16px,3vw,40px) auto; padding: clamp(12px,2.5vw,24px); isolation:isolate; }

/* =========================
   Hero = glass gradient like model
   ========================= */
.grade-calc-hero{
  position:relative;
  padding: clamp(18px,3vw,28px);
  border:1px solid var(--color-border);
  background: linear-gradient(135deg,
      color-mix(in oklab, var(--color-primary) 20%, transparent),
      color-mix(in oklab, var(--color-accent) 18%, transparent)
    ) border-box;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-1);
  overflow:hidden;
}
.grade-calc-hero::after{
  content:""; position:absolute; inset:-3px; pointer-events:none; filter: blur(16px); opacity:.6;
  background:
    radial-gradient(600px 220px at 18% -6%, color-mix(in oklab, var(--color-primary) 28%, transparent), transparent 65%),
    radial-gradient(460px 280px at 86% 0%,  color-mix(in oklab, var(--color-accent) 26%, transparent), transparent 62%);
}
.grade-calc-badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 12px; border:1px solid var(--color-border); border-radius:999px;
  color:rgba(255,255,255,.78); background: color-mix(in oklab, var(--color-bg-dark) 72%, transparent);
  font:600 12px/1 var(--font-body);
}
.grade-calc-badge .dot{ width:8px; height:8px; border-radius:999px; background:var(--color-accent); }
.grade-calc-title{
  margin:10px 0 6px 0;
  font: 800 clamp(26px,3.2vw,40px)/1.12 var(--font-heading);
  letter-spacing:.2px;
  background: linear-gradient(90deg, #fff,
    color-mix(in oklab, var(--color-primary) 54%, #fff) 38%,
    color-mix(in oklab, var(--gradient-cta-end) 40%, #fff) 78%,
    #fff);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.grade-calc-subtitle{ color: rgba(255,255,255,.78); font-size:clamp(14px,1.8vw,16px); max-width:80ch; }

/* =========================
   Primary actions (toolbar)
   ========================= */
.grade-calc-actions{ display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; }
.gc-btn{
  --_bg: linear-gradient(180deg,
    color-mix(in oklab, var(--color-primary) 70%, transparent),
    color-mix(in oklab, var(--color-accent) 62%, transparent));
  --_txt:#fff; --_bd: color-mix(in oklab, #000 12%, var(--color-primary));
  appearance:none; border:1px solid var(--_bd); background:var(--_bg); color:var(--_txt);
  padding:10px 12px; border-radius:12px; font-weight:700; font-size:13px; letter-spacing:.3px; cursor:pointer; position:relative;
  transition: transform .15s ease, filter .15s ease, box-shadow .2s ease, background .3s ease;
  box-shadow: 0 10px 20px rgba(29,78,216,.22), 0 6px 14px rgba(59,130,246,.16);
  font-family: var(--font-heading);
}
.gc-btn.primary{ /* already filled */ }
.gc-btn.ghost{ background: transparent; color: #e5e7eb; border:1px dashed var(--color-border); box-shadow:none; font-weight:600; }
.gc-btn:hover{ transform: translateY(-1px); filter: brightness(1.06); }
.gc-btn:active{ transform: translateY(0); filter: brightness(.98); }
.gc-hidden{ display:none !important; }

/* =========================
   Main grid
   ========================= */
.grade-calc-grid{
  display:grid; grid-template-columns: 1.15fr .85fr; gap: clamp(12px,2.4vw,20px); margin-top: clamp(14px,2.6vw,24px);
}
@media (max-width: 980px){ .grade-calc-grid{ grid-template-columns:1fr; } }

/* =========================
   Cards = glass surfaces
   ========================= */
.gc-card{
  border:1px solid var(--color-border);
  border-radius: var(--radius-lg);
  background: rgba(255,255,255,0.06);
  box-shadow: var(--shadow-2);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  overflow:hidden;
}
.gc-card > header{
  padding:12px 14px; border-bottom:1px solid var(--color-border);
  background: linear-gradient(90deg,
    color-mix(in oklab, var(--color-accent) 11%, transparent),
    color-mix(in oklab, var(--color-primary) 9%, transparent)
  );
}
.gc-card > header h2{
  margin:0; font:700 14px/1 var(--font-heading); letter-spacing:.35px; text-transform:uppercase; opacity:.92;
}
.gc-body{ padding:12px 14px; }

/* =========================
   Forms & rows
   ========================= */
.gc-row{ display:grid; gap:10px; grid-template-columns: repeat(2,1fr); }
@media (max-width: 720px){ .gc-row{ grid-template-columns:1fr; } }
.gc-field{ display:grid; gap:6px; }
.gc-label{ font:700 12px/1 var(--font-heading); color:#cfd6e4; letter-spacing:.04em; }

.gc-input,.gc-select,.gc-number{
  width:100%; padding:10px 12px; border-radius: var(--radius-md);
  background:#0f1b34; color:#e5e7eb; border:1px solid var(--color-border); outline:0; min-height:36px;
  transition:border-color .2s ease, box-shadow .2s ease, background .2s ease;
  font-family: var(--font-body);
}
.gc-select{ background:#0e1730; }
.gc-input::placeholder{ color:#94a3b8; }
.gc-input:focus,.gc-select:focus,.gc-number:focus{ border-color: rgba(59,130,246,.35); box-shadow: 0 0 0 3px rgba(59,130,246,.15); }

/* Category list & items */
.gc-category{
  border:1px dashed var(--color-border); border-radius:14px; padding:12px; margin-bottom:12px;
  background: color-mix(in oklab, var(--color-bg-dark) 72%, transparent);
  backdrop-filter: blur(6px);
}
.gc-category header{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; justify-content:space-between; margin-bottom:8px; }
.gc-chip{ font:700 11px/1 var(--font-body); padding:6px 10px; border-radius:999px; border:1px solid var(--color-border); background: rgba(255,255,255,.03); color:#cbd5e1; }

.gc-mini{ display:inline-flex; gap:6px; align-items:center; }
.gc-mini .gc-number{ width:90px; }

.gc-item-row{ display:grid; grid-template-columns: 1.15fr .6fr .6fr auto; gap:8px; margin:8px 0; }
.gc-item-row .gc-number{ text-align:right; }
.gc-item-row button{
  border:1px solid var(--color-border); background: transparent; color:#cbd5e1;
  border-radius:10px; padding:8px 10px; cursor:pointer; transition: transform .15s ease, border-color .2s ease, background .2s ease;
}
.gc-item-row button:hover{ transform: translateY(-1px); border-color: var(--color-accent); background: rgba(59,130,246,.14); }

/* =========================
   Results KPIs + ring
   ========================= */
.gc-kpi{ display:grid; grid-template-columns: repeat(3,1fr); gap:12px; }
.gc-kpi .tile{
  background: rgba(255,255,255,.06); border:1px solid var(--color-border); border-radius:12px; padding:14px; backdrop-filter: blur(8px);
}
.tile .label{ font:700 11px/1 var(--font-heading); color:#AAB6C7; letter-spacing:.06em; text-transform:uppercase; }
.tile .value{ font:800 24px/1.1 var(--font-heading); margin-top:6px; color:#fff; }

.gc-center{text-align:center;}
.gc-muted{ color:#AAB6C7; font-size:12px; }

.gc-ring{
  --ring-color: var(--color-accent);
  width:160px; height:160px; border-radius:999px; margin:auto; position:relative;
  background: conic-gradient(var(--ring-color) var(--ring-deg), #1c2748 0);
  box-shadow: 0 10px 28px rgba(0,0,0,.35);
}
.gc-ring::after{
  content:""; position:absolute; inset:10px; border-radius:999px;
  background: rgba(255,255,255,.06);
  border:1px solid var(--color-border);
  backdrop-filter: blur(10px);
}
.gc-ring-val{ position:absolute; inset:0; display:grid; place-items:center; font:800 26px/1 var(--font-heading); color:#fff; }
.gc-ring-sub{ position:absolute; inset:0; display:grid; place-items:end center; padding-bottom:18px; color:#AAB6C7; font-weight:700; }

/* =========================
   Toolbar pills & codebox
   ========================= */
.gc-toolbar{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px; }
.gc-pill{
  padding:8px 12px; border:1px solid var(--color-border);
  background: color-mix(in oklab, var(--color-bg-dark) 72%, transparent); color:#e5e7eb;
  border-radius:999px; font-weight:700; cursor:pointer;
  transition: transform .15s ease, border-color .2s ease, background .2s ease, box-shadow .2s ease;
  backdrop-filter: blur(6px);
}
.gc-pill:hover{ transform: translateY(-1px); border-color: var(--color-accent); background: rgba(59,130,246,.14); }
.gc-pill[aria-pressed="true"]{ border-color: var(--color-accent); box-shadow: 0 0 0 3px rgba(59,130,246,.20); }

.gc-codebox{ background: rgba(255,255,255,.06); color:#e5e9f4; border:1px solid var(--color-border); border-radius:12px; overflow:auto; padding:12px; font:12px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, "Roboto Mono", monospace; }
.gc-codebox.small{ font-size:12px; }

/* =========================
   Utility spacing (preserved)
   ========================= */
.flex{ display:flex; } .gap-8{ gap:8px; } .right{ text-align:right; }
.mt-8{ margin-top:8px; } .mt-16{ margin-top:16px; } .mt-22{ margin-top:22px; } .mt-28{ margin-top:28px; }
.mb-8{ margin-bottom:8px; } .small{ font-size:12px; }
.success{ color:#16a34a; } .warn{ color:var(--color-used-often); } .danger{ color:#ef4444; }

/* =========================
   Links inside content
   ========================= */
.gc-body a{ color:#93c5fd; text-decoration:underline; text-underline-offset:.18em; }
.gc-body a:hover{ text-decoration:none; }

/* =========================
   Subtle float animation like model
   ========================= */
@media (prefers-reduced-motion: no-preference){
  .gc-card { animation: gc-float 18s ease-in-out infinite; }
  @keyframes gc-float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-2px)} }
}

/* =========================
   Responsive extras for dense areas
   ========================= */
@media (max-width: 860px){
  .gc-item-row{ grid-template-columns: 1fr .7fr .7fr auto; }
}
@media (max-width: 560px){
  .gc-item-row{ grid-template-columns: 1fr 1fr; }
  .gc-item-row .gc-number{ text-align:left; }
}

.feature-card-all-pages {margin: 0 2rem;}
.tools-grid {margin: 1rem; background: #0e1730;}
.tool-card {background: #0f1b34;}
@media (max-width: 600px) { .tools-grid {margin: 1rem 0;} }

  </style>
</head>
<body class="grade-calc-page">



    
  
<nav id="main-navbar">
  <div class="nav-container">
    <div class="logo">
      <a href="/index.html">Snip Text</a>
    </div>
    <div class="hamburger" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <ul class="nav-links" id="nav-links">
      <li><a href="/index.html">Home</a></li>
      <li><a href="/tools/free-tools.html">Free Tools</a></li>
      <li><a href="/features.html">Features</a></li>
      <li><a href="/about.html">About</a></li>
      <li><a href="/blog/blog.html">Blog</a></li>
      <li><a href="/contact.html">Contact</a></li>
      <li><a id="nav-dashboard-link" href="/login.html">Dashboard</a></li>
      <li><a id="nav-logout-link" href="#" style="display:none;">Logout</a></li>
    </ul>
  </div>
</nav>






  <main class="grade-calc-container" id="home">
    <section class="grade-calc-hero gc-animate">
      <span class="grade-calc-badge" aria-hidden="true"><span class="dot"></span> Tools · Grade Calculator</span>
      <h1 class="grade-calc-title">Grade Calculator</h1>
      <p class="grade-calc-subtitle">Convert percentages to letter grades and compute a weighted average across categories. Drop lowest scores, simulate upcoming exams, estimate the score you need to hit your target, and export your plan. Everything is private and runs in your browser.</p>

      <div class="grade-calc-actions" role="group" aria-label="Primary actions">
        <button class="gc-btn primary" id="gc-add-category">Add category</button>
        <button class="gc-btn" id="gc-insert-sample">Insert sample</button>
        <label class="gc-btn ghost" for="gc-import-file">
          <input id="gc-import-file" type="file" accept=".json,.csv,text/csv,application/json" class="gc-hidden" /> Import JSON/CSV
        </label>
        <button class="gc-btn" id="gc-export-json">Export JSON</button>
        <button class="gc-btn" id="gc-reset">Reset</button>
      </div>

      <div class="grade-calc-grid">
        <!-- Left: Inputs -->
        <article class="gc-card gc-animate" style="animation-delay:.05s">
          <header><h2>Categories & items</h2></header>
          <div class="gc-body">
            <p class="gc-muted mb-8">Tip - weights should sum to 100. You can enable auto-normalize in Settings.</p>
            <div id="gc-category-list"></div>
            <div class="mt-16">
              <button class="gc-pill" id="gc-normalize">Normalize weights to 100</button>
              <button class="gc-pill" id="gc-expand-all">Expand all</button>
              <button class="gc-pill" id="gc-collapse-all">Collapse all</button>
            </div>
          </div>
        </article>

        <!-- Right: Results -->
        <aside class="gc-card gc-animate" style="animation-delay:.10s">
          <header><h2>Results</h2></header>
          <div class="gc-body">
            <div class="gc-kpi">
              <div class="tile">
                <div class="label">Overall</div>
                <div class="value" id="gc-overall">0.00%</div>
              </div>
              <div class="tile">
                <div class="label">Letter</div>
                <div class="value" id="gc-letter">-</div>
              </div>
              <div class="tile">
                <div class="label">GPA (4.0)</div>
                <div class="value" id="gc-gpa">0.00</div>
              </div>
            </div>

            <div class="mt-22 gc-center">
              <div class="gc-ring" id="gc-ring" style="--ring-deg:0deg; --ring-color: #3B82F6;">
                <div class="gc-ring-val" id="gc-ring-val">0%</div>
                <div class="gc-ring-sub" id="gc-ring-sub">On track</div>
              </div>
              <p class="gc-muted mt-8" id="gc-weight-note">Weights sum: 0%</p>
            </div>

            <div class="mt-22">
              <div class="gc-toolbar" role="group" aria-label="Tools">
                <button class="gc-pill" id="gc-copy-summary">Copy summary</button>
                <button class="gc-pill" id="gc-download-csv">Download CSV</button>
                <button class="gc-pill" id="gc-share-url">Copy shareable URL</button>
                <button class="gc-pill" id="gc-clear-drops">Clear drops</button>
              </div>
              <div class="gc-codebox small" id="gc-summary" aria-live="polite">Summary will appear here.</div>
            </div>
          </div>
        </aside>
      </div>

      <!-- Grade scale & What-if -->
      <article class="gc-card gc-animate mt-22" style="animation-delay:.15s">
        <header><h2>Grade scale & settings</h2></header>
        <div class="gc-body">
          <div class="gc-row">
            <div class="gc-field">
              <label class="gc-label">Letter grade thresholds (min %)</label>
              <div id="gc-scale"></div>
              <div class="mt-8">
                <button class="gc-pill" id="gc-scale-default">Reset to US default</button>
                <button class="gc-pill" id="gc-scale-uk">UK style example</button>
                <button class="gc-pill" id="gc-scale-eu">EU style example</button>
              </div>
            </div>
            <div class="gc-field">
              <label class="gc-label">Settings</label>
              <div class="mt-8">
                <label class="gc-muted flex gap-8"><input id="gc-auto-normalize" type="checkbox" /> Auto-normalize weights to 100 for calculation</label>
                <label class="gc-muted flex gap-8 mt-8"><input id="gc-count-empty" type="checkbox" /> Count empty items as 0 (unchecked means ignore)</label>
                <label class="gc-muted flex gap-8 mt-8"><input id="gc-round-display" type="checkbox" checked /> Round display to 2 decimals</label>
              </div>
              <div class="mt-16 gc-row">
                <div class="gc-field">
                  <label class="gc-label">GPA for A, A-, B+, ...</label>
                  <input id="gc-gpa-map" class="gc-input" value='{"A+":4.0,"A":4.0,"A-":3.7,"B+":3.3,"B":3.0,"B-":2.7,"C+":2.3,"C":2.0,"C-":1.7,"D":1.0,"F":0.0}' />
                  <small class="gc-muted">JSON map - edit if your school differs.</small>
                </div>
                <div class="gc-field">
                  <label class="gc-label">Theme accent</label>
                  <select id="gc-theme" class="gc-select">
                    <option value="#3B82F6" selected>SnipText Blue</option>
                    <option value="#22c55e">Emerald</option>
                    <option value="#e85d27">Tangerine</option>
                    <option value="#a855f7">Violet</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </article>

      <article class="gc-card gc-animate mt-22" style="animation-delay:.20s">
        <header><h2>What-if & target grade</h2></header>
        <div class="gc-body">
          <div class="gc-row">
            <div class="gc-field">
              <label class="gc-label">What-if simulator</label>
              <p class="gc-muted">Pick a category and move the slider to simulate a hypothetical score for an upcoming item. This does not overwrite your data - it is temporary.</p>
              <div class="gc-row">
                <select id="gc-whatif-cat" class="gc-select"></select>
                <input id="gc-whatif-score" class="gc-number" type="number" min="0" max="100" value="85" />
              </div>
              <input id="gc-whatif-range" type="range" min="0" max="100" value="85" class="mt-8" />
              <div class="mt-8 small" id="gc-whatif-out">What-if overall: -</div>
            </div>

            <div class="gc-field">
              <label class="gc-label">Target grade - required on remaining</label>
              <div class="gc-row">
                <input id="gc-target-percent" class="gc-number" type="number" min="0" max="100" step="0.1" placeholder="Target %" />
                <select id="gc-target-letter" class="gc-select">
                  <option value="">or pick letter</option>
                </select>
              </div>
              <div class="gc-row mt-8">
                <input id="gc-remaining-weight" class="gc-number" type="number" min="0" max="100" step="0.1" placeholder="Unscored weight %" />
                <button class="gc-pill" id="gc-target-calc">Calculate</button>
              </div>
              <div class="mt-8 small" id="gc-target-out">Required on remaining: -</div>
            </div>
          </div>
        </div>
      </article>

      <!-- About -->
      <section id="about" class="gc-animate mt-28">
        <div class="gc-card">
          <header><h2>About this tool</h2></header>
          <div class="gc-body">
            <p>The SnipText Grade Calculator helps students, teachers, and TAs compute accurate course grades. Add categories like Homework, Quizzes, Midterm, and Final with weights that match your syllabus. Enter items as points earned over points possible. Drop the lowest N items per category and the calculator recomputes everything, including the final letter grade and GPA estimate.</p>
            <p>For tidy reporting, pair this with the <a href="/tools/quick-table-generator-csv-to-html-table-code.html">Quick Table Generator</a> to publish results as accessible HTML tables. Planning a course timeline? Try the <a href="/tools/timeline-maker-academic-timeline.html">Timeline Maker</a>. Writing up methods or lab notes? The <a href="/tools/math-formula-renderer-latex-to-image-png-svg.html">Math Formula Renderer</a> and <a href="/tools/bibtex-to-citation-to-bibtex.html">BibTeX to Citation Converter</a> are student favorites. Keep data tidy with the <a href="/tools/word-counter.html">Word and Character Counter</a> and the <a href="/tools/text-to-list-to-text-converter.html">Text ↔ List Converter</a>.</p>
          </div>
        </div>
      </section>

      <!-- FAQ short -->
      <section id="faq" class="gc-animate mt-22">
        <div class="gc-card">
          <header><h2>FAQ</h2></header>
          <div class="gc-body">
            <details><summary>Does this match my school’s curve?</summary><p>Many schools use similar thresholds, but you can edit the scale to match your syllabus exactly - the calculator validates the order.</p></details>
            <details><summary>What if weights don’t add to 100?</summary><p>Use Normalize or enable auto-normalize so calculations proportionally scale to 100.</p></details>
            <details><summary>Can I paste data from Sheets?</summary><p>Yes. Use CSV import or paste assignments with commas into a category using the Add items dialog.</p></details>
          </div>
        </div>
      </section>
    </section>


     <div class="free-tools-guide">
    <p class="free-tools-guide-p">See Grade Calculation Guide on SnipText Blog Page <a href="/blog/grade-calculator-percentage-to-letter-grade-weighted-average-gpa-required-final-score-academic-grading-guide-sniptext-blog.html" class="free-tools-blog-link">here</a>.</p>
  </div>

  </main>


    <!-- TOOLS GRID -->
       <div class="feature-card-all-pages">
        <h1 class="feature-card-all-pages-para">Featured Tools</h1>
       </div>
  <section id="tools-grid" class="tools-grid" aria-label="Tools list">
    <!-- Tool cards - 10 items -->

    <article class="tool-card table-gen-tool-card" tabindex="0" data-href="/tools/quick-table-generator-csv-to-html-table-code.html" aria-labelledby="table-gen-tg">
        <div class="card-icon table-gen-card-icon" aria-hidden="true">
          <!-- Grid/Table icon -->
          <svg viewBox="0 0 24 24" class="svg-icon table-gen-svg" xmlns="http://www.w3.org/2000/svg" role="img">
            <rect x="3" y="4" width="18" height="16" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.4"/>
            <path d="M3 9h18M3 14h18M8 4v16M14 4v16" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
          </svg>
        </div>
        <h3 id="table-gen-tg" class="card-title table-gen-card-title">Quick Table Generator</h3>
        <p class="card-desc table-gen-card-desc">
          Paste or upload CSV to generate clean, responsive HTML table code with auto-detect delimiter, header toggle, sort, filter, paginate, transpose, sticky header, and one-click copy or download. Private, in-browser.
        </p>
        <a class="card-cta table-gen-card-cta" href="/tools/quick-table-generator-csv-to-html-table-code.html" aria-label="Open Quick Table Generator">Open →</a>
      </article>

      <article class="tool-card" tabindex="0" data-href="/tools/timeline-maker-academic-timeline.html" aria-labelledby="t13">
          <div class="card-icon" aria-hidden="true">
            <!-- Timeline icon: calendar + vertical line with nodes -->
            <svg viewBox="0 0 24 24" class="svg-icon">
              <!-- Calendar frame -->
              <rect x="3" y="4.5" width="18" height="16" rx="2.5" ry="2.5" stroke="currentColor" stroke-width="1.4" fill="none"/>
              <path d="M3 8h18" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" />
              <path d="M8 4.5v-2M16 4.5v-2" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
              <!-- Vertical timeline -->
              <path d="M8.5 11v7" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
              <circle cx="8.5" cy="12.5" r="1.4" fill="currentColor"/>
              <circle cx="8.5" cy="15.5" r="1.4" fill="currentColor"/>
              <circle cx="8.5" cy="18" r="1.4" fill="currentColor"/>
              <!-- Event cards hint -->
              <path d="M11.5 12.5h6M11.5 15.5h5M11.5 18h4" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
            </svg>
          </div>
          <h3 id="t13" class="card-title">Timeline Maker</h3>
          <p class="card-desc">Enter events to auto-generate an academic-style timeline with categories, eras, zoom, drag-reorder, and one-click export to HTML, SVG, or JSON. Private, in-browser.</p>
          <a class="card-cta" href="/tools/timeline-maker-academic-timeline.html" aria-label="Open Timeline Maker">Open →</a>
        </article>

    <article class="tool-card" tabindex="0" data-href="/tools/duplicate-word-finder.html" aria-labelledby="t3">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M3 7h8v10H3zM13 3h8v10h-8z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t3" class="card-title">Duplicate Word Finder</h3>
      <p class="card-desc">Find repeated words and common duplicates, with options to highlight or remove them automatically.</p>
      <a class="card-cta" href="/tools/duplicate-word-finder.html" aria-label="Open Duplicate Word Finder">Open →</a>
    </article>

    <article class="tool-card" tabindex="0" data-href="/tools/whitespace-and-formatting-cleaner.html" aria-labelledby="t4">
      <div class="card-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" class="svg-icon">
          <path d="M3 7h18M8 11h8M6 15h12M4 19h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </div>
      <h3 id="t4" class="card-title">Whitespace & Formatting Cleaner</h3>
      <p class="card-desc">Trim whitespace, normalize newlines, remove extra spaces, and fix inconsistent indentation.</p>
      <a class="card-cta" href="/tools/whitespace-and-formatting-cleaner.html" aria-label="Open Whitespace & Formatting Cleaner">Open →</a>
    </article>

  </section>






  
<footer id="main-footer" class="site-footer" aria-labelledby="footer-heading">
  <!-- decorative background -->
  <div class="footer-bg" aria-hidden="true"></div>

  <div class="footer-container">
    <div class="footer-logo">
      <h2 id="footer-heading" class="footer-brand">Snip Text</h2>
      <p>Empowering better writing, one tool at a time.</p>
    </div>

    <nav class="footer-links" aria-label="Footer links">
      <a href="feedback.html">Feedback</a>
      <a href="contact.html#contact">Contact Us</a>
      <a href="privacy-policy.html">Privacy Policy</a>
      <a href="terms-of-use.html">Terms of Use</a>
    </nav>

    <div class="footer-bottom">
      <p>
        &copy; <span id="year"></span>
        <span class="powered-by">
          Snip Text - powered by
          <a href="https://checkai.pro" target="_blank" rel="noopener">CheckAI.pro</a>
        </span>
        · All rights reserved.
      </p>
    </div>
  </div>

  <!-- back to top -->
  <button class="to-top" id="to-top" aria-label="Back to top">
    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
      <path d="M12 5l-6 6m6-6l6 6M12 5v14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
    </svg>
  </button>
</footer>





<script src="/js/index.js?v=reset1" defer></script>
  <script src="/js/auth.js?v=reset1"></script>
<script src="/tools/js/free-tools.js?v=reset1"></script>

  <script>
    (function(){
      const qs = (s, r=document)=>r.querySelector(s);
      const qsa = (s, r=document)=>Array.from(r.querySelectorAll(s));

      // Elements
      const $catList = qs('#gc-category-list');
      const $addCat = qs('#gc-add-category');
      const $insertSample = qs('#gc-insert-sample');
      const $importFile = qs('#gc-import-file');
      const $exportJSON = qs('#gc-export-json');
      const $reset = qs('#gc-reset');
      const $normalize = qs('#gc-normalize');
      const $expandAll = qs('#gc-expand-all');
      const $collapseAll = qs('#gc-collapse-all');

      const $overall = qs('#gc-overall');
      const $letter = qs('#gc-letter');
      const $gpa = qs('#gc-gpa');
      const $ring = qs('#gc-ring');
      const $ringVal = qs('#gc-ring-val');
      const $ringSub = qs('#gc-ring-sub');
      const $weightNote = qs('#gc-weight-note');
      const $summary = qs('#gc-summary');

      const $downloadCSV = qs('#gc-download-csv');
      const $copySummary = qs('#gc-copy-summary');
      const $shareURL = qs('#gc-share-url');

      const $scaleWrap = qs('#gc-scale');
      const $scaleDefault = qs('#gc-scale-default');
      const $scaleUK = qs('#gc-scale-uk');
      const $scaleEU = qs('#gc-scale-eu');
      const $autoNormalize = qs('#gc-auto-normalize');
      const $countEmpty = qs('#gc-count-empty');
      const $roundDisplay = qs('#gc-round-display');
      const $gpaMap = qs('#gc-gpa-map');
      const $theme = qs('#gc-theme');

      const $whatIfCat = qs('#gc-whatif-cat');
      const $whatIfScore = qs('#gc-whatif-score');
      const $whatIfRange = qs('#gc-whatif-range');
      const $whatIfOut = qs('#gc-whatif-out');

      const $targetPercent = qs('#gc-target-percent');
      const $targetLetter = qs('#gc-target-letter');
      const $remainingWeight = qs('#gc-remaining-weight');
      const $targetCalc = qs('#gc-target-calc');
      const $targetOut = qs('#gc-target-out');

const yEl = qs('#gc-year') || qs('#year');
    if (yEl) yEl.textContent = new Date().getFullYear();

      // Model
      let model = {
        categories: [],
        scale: [ // US default
          {grade:'A+', min:97}, {grade:'A', min:93}, {grade:'A-', min:90},
          {grade:'B+', min:87}, {grade:'B', min:83}, {grade:'B-', min:80},
          {grade:'C+', min:77}, {grade:'C', min:73}, {grade:'C-', min:70},
          {grade:'D', min:60}, {grade:'F', min:0}
        ],
        settings: {
          autoNormalize: false,
          countEmptyAsZero: false,
          roundDisplay: true,
          theme: '#3B82F6'
        }
      };

      // Helpers
      const uid = ()=>Math.random().toString(36).slice(2,9);
      const clamp = (n, a, b)=>Math.max(a, Math.min(b, n));
      const round2 = v=>model.settings.roundDisplay ? (Math.round(v*100)/100) : v;

      function letterFromPercent(p){
        for (const s of model.scale){ if (p >= s.min) return s.grade; }
        return model.scale[model.scale.length-1]?.grade || 'F';
      }
      function gpaFromLetter(L){
        try{
          const map = JSON.parse($gpaMap.value || '{}');
          return (map[L] ?? 0);
        }catch{ return 0; }
      }

      // Storage & URL
      function save(){
        localStorage.setItem('grade-calc-state', JSON.stringify(model));
        updateShareURL(true);
      }
      function load(){
        try{
          const hash = location.hash.startsWith('#gc=') ? decodeURIComponent(location.hash.slice(4)) : '';
          if (hash){
            const parsed = JSON.parse(atob(hash));
            if (parsed && parsed.categories) model = parsed;
          } else {
            const st = JSON.parse(localStorage.getItem('grade-calc-state') || '{}');
            if (st && st.categories) model = st;
          }
        }catch{}
      }

      function updateShareURL(silent){
        try{
          const mini = {...model};
          // keep small: drop computed fields if any
          const enc = btoa(JSON.stringify(mini)).replace(/=+$/,'');
          const url = location.origin + location.pathname + '#gc=' + encodeURIComponent(enc);
          if (!silent) navigator.clipboard.writeText(url).then(()=>toast('Shareable URL copied'));
          // do not pushState to avoid clutter
        }catch{}
      }

      // UI - Scale table
      function renderScale(){
        $scaleWrap.innerHTML = '';
        const tbl = document.createElement('div');
        for (let i=0;i<model.scale.length;i++){
          const row = document.createElement('div');
          row.className = 'gc-item-row';
          row.innerHTML = `
            <input class="gc-input" value="${model.scale[i].grade}" aria-label="Grade label">
            <input class="gc-number" type="number" min="0" max="100" value="${model.scale[i].min}" aria-label="Minimum percent">
            <div></div>
            <button type="button" data-i="${i}" class="gc-del-scale">Remove</button>
          `;
          const [gEl, mEl] = row.querySelectorAll('input');
          gEl.addEventListener('input', ()=>{ model.scale[i].grade = gEl.value.trim(); renderTargets(); save(); recalc(); });
          mEl.addEventListener('input', ()=>{
            model.scale[i].min = clamp(Number(mEl.value||0), 0, 100);
            model.scale.sort((a,b)=>b.min-a.min);
            renderScale(); renderTargets(); save(); recalc();
          });
          row.querySelector('.gc-del-scale').addEventListener('click', ()=>{
            model.scale.splice(i,1); renderScale(); renderTargets(); save(); recalc();
          });
          tbl.appendChild(row);
        }
        const add = document.createElement('div');
        add.className = 'gc-item-row';
        add.innerHTML = `
          <input class="gc-input" placeholder="Grade (e.g., A*)" aria-label="New grade">
          <input class="gc-number" type="number" min="0" max="100" placeholder="Min %" aria-label="New min percent">
          <div></div>
          <button type="button" class="gc-add-scale">Add</button>
        `;
        add.querySelector('.gc-add-scale').addEventListener('click', ()=>{
          const g = add.querySelector('.gc-input').value.trim() || 'New';
          const m = clamp(Number(add.querySelector('.gc-number').value||0),0,100);
          model.scale.push({grade:g, min:m});
          model.scale.sort((a,b)=>b.min-a.min);
          renderScale(); renderTargets(); save(); recalc();
        });
        $scaleWrap.appendChild(tbl);
        // Fill target letter select
        renderTargets();
      }

      function renderTargets(){
        const current = $targetLetter.value;
        $targetLetter.innerHTML = '<option value="">or pick letter</option>' + model.scale.map(s=>`<option value="${s.grade}">${s.grade}</option>`).join('');
        if (current) $targetLetter.value = current;
        // what-if cat select
        $whatIfCat.innerHTML = model.categories.map(c=>`<option value="${c.id}">${c.name}</option>`).join('') || '<option value="">No categories</option>';
      }

      // UI - Categories
      function renderCategories(){
        $catList.innerHTML = '';
        for (const c of model.categories){
          const cat = document.createElement('div');
          cat.className = 'gc-category';
          cat.dataset.id = c.id;
          const expanded = c.expanded ?? true;

          const dropVal = Number(c.drop||0);
          cat.innerHTML = `
            <header>
              <div class="flex gap-8" style="align-items:center">
                <strong>${c.name}</strong>
                <span class="gc-chip">Weight: <input class="gc-number" style="width:70px;margin-left:6px" value="${c.weight}" min="0" max="100" step="0.1" aria-label="Category weight %">%</span>
                <span class="gc-chip">Drop lowest: <input class="gc-number" style="width:60px;margin-left:6px" value="${dropVal}" min="0" step="1" aria-label="Drop lowest count"></span>
              </div>
              <div class="gc-mini">
                <button class="gc-pill gc-toggle" aria-expanded="${expanded}">${expanded ? 'Collapse' : 'Expand'}</button>
                <button class="gc-pill gc-add-item">Add item</button>
                <button class="gc-pill gc-del-cat danger">Delete</button>
              </div>
            </header>
            <div class="gc-items" style="${expanded?'':'display:none'}"></div>
            <div class="small gc-muted mt-8" id="meta-${c.id}"></div>
          `;
          // events header
          const [wEl, dEl] = cat.querySelectorAll('.gc-number');
          wEl.addEventListener('input', ()=>{ c.weight = Number(wEl.value||0); save(); recalc(); });
          dEl.addEventListener('input', ()=>{ c.drop = Math.max(0, Math.floor(Number(dEl.value||0))); save(); recalc(); });

          cat.querySelector('.gc-toggle').addEventListener('click', (e)=>{
            c.expanded = !(c.expanded ?? true);
            renderCategories();
            save();
          });
          cat.querySelector('.gc-del-cat').addEventListener('click', ()=>{
            model.categories = model.categories.filter(x=>x.id!==c.id); renderCategories(); save(); recalc();
          });
          cat.querySelector('.gc-add-item').addEventListener('click', ()=>{ addItem(c.id); });

          // items
          const itemsWrap = cat.querySelector('.gc-items');
          for (const it of c.items){
            const row = document.createElement('div');
            row.className = 'gc-item-row';
            row.innerHTML = `
              <input class="gc-input" value="${it.name}" placeholder="Assignment name" aria-label="Item name">
              <input class="gc-number" type="number" min="0" step="0.01" value="${it.earned ?? ''}" placeholder="Earned" aria-label="Points earned">
              <input class="gc-number" type="number" min="0" step="0.01" value="${it.total ?? ''}" placeholder="Total" aria-label="Points total">
              <button class="gc-del-item">Remove</button>
            `;
            const [nEl, eEl, tEl] = row.querySelectorAll('input');
            nEl.addEventListener('input', ()=>{ it.name = nEl.value; save(); });
            eEl.addEventListener('input', ()=>{ it.earned = eEl.value===''? '' : Number(eEl.value); save(); recalc(); });
            tEl.addEventListener('input', ()=>{ it.total = tEl.value===''? '' : Number(tEl.value); save(); recalc(); });
            row.querySelector('.gc-del-item').addEventListener('click', ()=>{
              c.items = c.items.filter(x=>x.id!==it.id); renderCategories(); save(); recalc();
            });
            itemsWrap.appendChild(row);
          }

          // meta line
          $catList.appendChild(cat);
        }
        renderTargets();
      }

      function addCategory(name='New Category', weight=20){
        model.categories.push({ id:uid(), name, weight, drop:0, expanded:true, items:[] });
        renderCategories(); save(); recalc();
      }
      function addItem(catId, name='Item', earned='', total=''){
        const c = model.categories.find(x=>x.id===catId);
        if (!c) return;
        c.items.push({ id:uid(), name, earned, total });
        renderCategories(); save(); recalc();
      }

      // Calculation
      function compute(){
        const countEmpty = $countEmpty.checked;
        const normalize = $autoNormalize.checked;

        // By category
        let weightSum = 0;
        for (const c of model.categories){ weightSum += Number(c.weight||0); }

        const effWeightSum = normalize && weightSum>0 ? 100 : weightSum;

        let overall = 0;
        for (const c of model.categories){
          // build usable list (ignore empty if not counting)
          let items = c.items.filter(it=>{
            if (it.total === 0) return false;
            if (it.earned==='' || it.total===''){ return countEmpty; }
            return true;
          }).map(it=>{
            const e = (it.earned===''||it.total==='') ? 0 : Number(it.earned);
            const t = (it.earned===''||it.total==='') ? 1 : Number(it.total);
            return { ...it, pct: t>0 ? (e/t*100) : 0 };
          });

          // drop lowest N by pct
          const dropN = Math.min(Number(c.drop||0), items.length);
          if (dropN>0){
            items.sort((a,b)=>a.pct-b.pct);
            items = items.slice(dropN);
          }

          // category avg
          const catPct = items.length ? (items.reduce((s,x)=>s+x.pct,0)/items.length) : 0;

          // effective weight
          const cw = Number(c.weight||0);
          const effW = (normalize && weightSum>0) ? (cw/weightSum*100) : cw;

          // contribution
          c._avg = catPct;
          c._effW = effW;
          c._contrib = catPct * (effW/100);

          // meta text
          const meta = qs('#meta-'+c.id);
          if (meta){
            const itemsCount = c.items.length;
            const used = items.length;
            const dropped = Math.max(0, itemsCount - used);
            meta.textContent = `Avg: ${round2(catPct).toFixed(2)}% · Effective weight: ${round2(effW).toFixed(2)}% · Dropped: ${dropped}`;
          }

          overall += c._contrib;
        }

        return { overall, weightSum: effWeightSum };
      }

      function recalc(){
        const {overall, weightSum} = compute();

        const pct = clamp(overall, 0, 999);
        const L = letterFromPercent(pct);
        const gpa = gpaFromLetter(L);

        $overall.textContent = round2(pct).toFixed(2) + '%';
        $letter.textContent = L;
        $gpa.textContent = round2(gpa).toFixed(2);

        // ring color
        let color = model.settings.theme || '#3B82F6';
        if (pct >= 90) color = 'var(--grade-calc-good)';
        else if (pct >= 70) color = 'var(--grade-calc-accent)';
        else if (pct >= 60) color = 'var(--grade-calc-warn)';
        else color = 'var(--grade-calc-bad)';

        const deg = (pct/100)*360 + 'deg';
        $ring.style.setProperty('--ring-deg', deg);
        $ring.style.setProperty('--ring-color', color);
        $ringVal.textContent = round2(pct).toFixed(0) + '%';
        $ringSub.textContent = pct>=90?'Excellent':pct>=80?'Great':pct>=70?'Solid':pct>=60?'Passing':'Needs attention';

        // note
        const rawSum = model.categories.reduce((s,c)=>s+Number(c.weight||0),0);
        $weightNote.innerHTML = `Weights sum: ${round2(rawSum).toFixed(2)}% ${$autoNormalize.checked ? '· Auto-normalize ON' : ''}`;

        // summary
        const rows = model.categories.map(c=>[
          c.name, round2(c._avg||0).toFixed(2)+'%', round2(c._effW||0).toFixed(2)+'%', round2(c._contrib||0).toFixed(2)+'%'
        ]);
        const header = ['Category','Average','Eff. Weight','Contribution'];
        const text = [header.join('\t')].concat(rows.map(r=>r.join('\t'))).join('\n');
        $summary.textContent = text;
      }

      // Exports
      function toCSV(){
        const lines = [['Category','Item','Earned','Total','Item %','Category Avg','Eff. Weight','Contribution']];
        for (const c of model.categories){
          for (const it of c.items){
            const pct = (it.total>0 && it.earned!=='' && it.total!=='') ? (it.earned/it.total*100) : '';
            lines.push([c.name, it.name, it.earned, it.total, pct===''?'':round2(pct).toFixed(2)+'%', '', '', '']);
          }
          lines.push([c.name,'-- category --','','','', round2(c._avg||0).toFixed(2)+'%', round2(c._effW||0).toFixed(2)+'%', round2(c._contrib||0).toFixed(2)+'%']);
        }
        return lines.map(r=>r.map(x=>String(x)).join(',')).join('\n');
      }
      function downloadBlob(name, content, type='text/plain'){
        const blob = new Blob([content], {type});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = name;
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(a.href);
      }

      // What-if
      function calcWhatIf(){
        const id = $whatIfCat.value;
        const score = Number($whatIfScore.value||0);
        if (!id) { $whatIfOut.textContent = 'What-if overall: -'; return; }
        // clone
        const snap = JSON.parse(JSON.stringify(model));
        const cat = snap.categories.find(c=>c.id===id);
        if (!cat) { $whatIfOut.textContent = 'What-if overall: -'; return; }
        // push a temp item: total 100, earned = score
        cat.items.push({id:'__temp__', name:'What-if', earned:score, total:100});
        const savedModel = model;
        model = snap;
        const {overall} = compute();
        model = savedModel;
        $whatIfOut.textContent = 'What-if overall: ' + round2(overall).toFixed(2) + '% (' + letterFromPercent(overall) + ')';
      }

      // Target
      function calcTarget(){
        let target = Number($targetPercent.value||0);
        const L = $targetLetter.value;
        if (!target && L){
          const s = model.scale.find(x=>x.grade===L);
          target = s ? s.min : 0;
        }
        const rem = Number($remainingWeight.value||0);
        if (!rem || !target){
          $targetOut.textContent = 'Required on remaining: -';
          return;
        }
        const {overall} = compute();
        const achievedPart = (100 - rem) / 100 * overall;
        const neededTotal = target;
        const neededRemainingPct = ((neededTotal - achievedPart) / (rem/100));
        const clamped = clamp(neededRemainingPct, 0, 999);
        const msg = clamped>100 ? `You need ${round2(clamped).toFixed(2)}% on the remaining ${rem}% - not feasible without extra credit.` :
                    `You need ${round2(clamped).toFixed(2)}% on the remaining ${rem}% of the grade.`;
        $targetOut.textContent = msg;
      }

      // Normalize
      function normalizeWeights(){
        const sum = model.categories.reduce((s,c)=>s+Number(c.weight||0),0);
        if (sum<=0) return;
        for (const c of model.categories) c.weight = Number(c.weight||0)/sum*100;
      }

      // Themes
      function applyTheme(){
        const col = $theme.value || '#3B82F6';
        model.settings.theme = col;
        $ring.style.setProperty('--ring-color', col);
        save(); recalc();
      }

      // Toast
      let toastTimer;
      function toast(msg){
        let el = qs('#gc-toast');
        if (!el){
          el = document.createElement('div');
          el.id = 'gc-toast';
          el.style.cssText = 'position:fixed;left:50%;bottom:26px;transform:translateX(-50%);background:#101a36;color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 12px 22px rgba(0,0,0,.35);z-index:9999;font:700 13px/1 var(--font-body);';
          document.body.appendChild(el);
        }
        el.textContent = msg;
        el.style.opacity = '1';
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=>{ el.style.opacity = '0'; }, 1500);
      }

      // Events
      $addCat.addEventListener('click', ()=>addCategory('Category ' + (model.categories.length+1), 20));
      $insertSample.addEventListener('click', ()=>{
        model.categories = [
          {id:uid(), name:'Homework', weight:25, drop:1, expanded:true, items:[
            {id:uid(), name:'HW1', earned:90, total:100},
            {id:uid(), name:'HW2', earned:85, total:100},
            {id:uid(), name:'HW3', earned:100, total:100}
          ]},
          {id:uid(), name:'Quizzes', weight:15, drop:0, expanded:true, items:[
            {id:uid(), name:'Quiz 1', earned:8, total:10},
            {id:uid(), name:'Quiz 2', earned:7, total:10}
          ]},
          {id:uid(), name:'Midterm', weight:30, drop:0, expanded:true, items:[
            {id:uid(), name:'MT', earned:78, total:100}
          ]},
          {id:uid(), name:'Final', weight:30, drop:0, expanded:true, items:[]}
        ];
        renderCategories(); save(); recalc(); toast('Sample added');
      });
      $exportJSON.addEventListener('click', ()=>{
        downloadBlob('grade-calc.json', JSON.stringify(model, null, 2), 'application/json');
      });
      $reset.addEventListener('click', ()=>{
        model.categories = []; renderCategories(); save(); recalc(); toast('Reset');
      });
      $normalize.addEventListener('click', ()=>{ normalizeWeights(); renderCategories(); save(); recalc(); toast('Weights normalized'); });
      $expandAll.addEventListener('click', ()=>{ model.categories.forEach(c=>c.expanded=true); renderCategories(); save(); });
      $collapseAll.addEventListener('click', ()=>{ model.categories.forEach(c=>c.expanded=false); renderCategories(); save(); });

      $downloadCSV.addEventListener('click', ()=>{ downloadBlob('grade-summary.csv', toCSV(), 'text/csv'); });
      $copySummary.addEventListener('click', ()=>{ navigator.clipboard.writeText($summary.textContent||'').then(()=>toast('Summary copied')); });
      $shareURL.addEventListener('click', ()=>updateShareURL(false));

      $importFile.addEventListener('change', async (e)=>{
        const f = e.target.files?.[0]; if (!f) return;
        const txt = await f.text();
        try{
          const j = JSON.parse(txt);
          if (j.categories) { model = j; }
        }catch{
          // CSV import: Category,Item,Earned,Total
          const lines = txt.split(/\r?\n/).filter(Boolean);
          const hdr = lines[0].split(',');
          const ci = {category: hdr.findIndex(h=>/category/i.test(h)), item: hdr.findIndex(h=>/item/i.test(h)), earned: hdr.findIndex(h=>/earned/i.test(h)), total: hdr.findIndex(h=>/total/i.test(h))};
          const cats = {};
          for (const line of lines.slice(1)){
            const cols = line.split(',');
            const cName = cols[ci.category] || 'Imported';
            if (!cats[cName]) cats[cName] = {id:uid(), name:cName, weight:20, drop:0, expanded:true, items:[]};
            cats[cName].items.push({id:uid(), name: cols[ci.item] || 'Item', earned: Number(cols[ci.earned]||0), total: Number(cols[ci.total]||0)});
          }
          model.categories = Object.values(cats);
        }
        renderCategories(); save(); recalc(); toast('Imported');
      });

      $scaleDefault.addEventListener('click', ()=>{
        model.scale = [
          {grade:'A+', min:97},{grade:'A', min:93},{grade:'A-', min:90},
          {grade:'B+', min:87},{grade:'B', min:83},{grade:'B-', min:80},
          {grade:'C+', min:77},{grade:'C', min:73},{grade:'C-', min:70},
          {grade:'D', min:60},{grade:'F', min:0}
        ];
        renderScale(); save(); recalc();
      });
      $scaleUK.addEventListener('click', ()=>{
        model.scale = [
          {grade:'First', min:70},{grade:'Upper Second', min:60},{grade:'Lower Second', min:50},
          {grade:'Third', min:40},{grade:'Fail', min:0}
        ];
        renderScale(); save(); recalc();
      });
      $scaleEU.addEventListener('click', ()=>{
        model.scale = [
          {grade:'A', min:90},{grade:'B', min:80},{grade:'C', min:70},{grade:'D', min:60},{grade:'E', min:50},{grade:'FX', min:40},{grade:'F', min:0}
        ];
        renderScale(); save(); recalc();
      });

      $autoNormalize.addEventListener('change', ()=>{ model.settings.autoNormalize = $autoNormalize.checked; save(); recalc(); });
      $countEmpty.addEventListener('change', ()=>{ model.settings.countEmptyAsZero = $countEmpty.checked; save(); recalc(); });
      $roundDisplay.addEventListener('change', ()=>{ model.settings.roundDisplay = $roundDisplay.checked; save(); recalc(); });
      $theme.addEventListener('change', applyTheme);

      $whatIfRange.addEventListener('input', e=>{ $whatIfScore.value = e.target.value; calcWhatIf(); });
      $whatIfScore.addEventListener('input', e=>{ $whatIfRange.value = e.target.value; calcWhatIf(); });
      $whatIfCat.addEventListener('change', calcWhatIf);

      $targetCalc.addEventListener('click', calcTarget);

      qs('#gc-clear-drops').addEventListener('click', ()=>{ model.categories.forEach(c=>c.drop=0); renderCategories(); save(); recalc(); });

      // Init
      load();
      renderScale();
      renderCategories();
      // restore settings UI
      $autoNormalize.checked = !!model.settings.autoNormalize;
      $countEmpty.checked = !!model.settings.countEmptyAsZero;
      $roundDisplay.checked = model.settings.roundDisplay!==false;
      $theme.value = model.settings.theme || '#3B82F6';
      applyTheme();
      recalc();

      // Keyboard shortcuts
      document.addEventListener('keydown', (e)=>{
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='n'){ e.preventDefault(); addCategory('Category '+(model.categories.length+1), 20); }
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='s'){ e.preventDefault(); downloadBlob('grade-calc.json', JSON.stringify(model,null,2), 'application/json'); }
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='c'){ e.preventDefault(); navigator.clipboard.writeText($summary.textContent||''); toast('Summary copied');}
      });
    })();
  </script>
</body>
</html>
